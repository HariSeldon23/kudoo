(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{11:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(652),r=function(e,t){void 0===e&&(e=""),void 0===t&&(t="");var a=e?"error":"success",r=e||t;Object(n.b)(r,{type:a,closeButton:!1,hideProgressBar:!0})}},2084:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(39),o=a(13),c=a(4),l=a.n(c),s=a(2),u=a(5),m=a(466);t.a=Object(s.withStyles)(m.a)((function(e){var t=e.classes,a=e.theme,n=e.customer,c=e.onSubmit,m=n.address,d=n.contact;return r.a.createElement("div",{className:t.section},r.a.createElement(s.SectionHeader,{title:"Customer Details",subtitle:"Edit customer details and save your changes. "}),r.a.createElement(i.Formik,{enableReinitialize:!0,initialValues:{street:m.street||"",city:m.city||"",state:m.state||"",country:m.country||"",postCode:m.postCode||"",landlineCode:d.landlineCode||"",landlineNumber:d.landlineNumber||"",mobileCode:d.mobileCode||"",mobileNumber:d.mobileNumber||""},validationSchema:o.object().shape({street:o.string().required("street is required"),city:o.string().required("city is required"),state:o.string().required("state is required"),country:o.string().required("country is required"),postCode:o.string().required("postCode is required"),landlineNumber:o.string().required("Number is required"),mobileNumber:o.string().required("Number is required")}),onSubmit:c},(function(e){var n=e.dirty;return r.a.createElement("form",{className:t.detailsForm,onSubmit:e.handleSubmit},r.a.createElement(l.a,{container:!0,spacing:40},r.a.createElement(l.a,{item:!0,xs:12,sm:6},r.a.createElement(s.SectionHeader,{title:"Address",classes:{component:t.formHeading}}),r.a.createElement(s.AddressForm,{keys:{street:"street",city:"city",state:"state",country:"country",postcode:"postCode"}})),r.a.createElement(l.a,{item:!0,xs:12,sm:6},r.a.createElement(s.SectionHeader,{title:"Company Contact Details",classes:{component:t.formHeading}}),r.a.createElement(s.PhoneNumberField,{areaCodeFieldName:"mobileCode",phoneNumberFieldName:"mobileNumber",areaCodeLabel:"Area Code",phoneNumberLabel:"Mobile Number",showClearIcon:!1}),r.a.createElement(s.PhoneNumberField,{areaCodeFieldName:"landlineCode",phoneNumberFieldName:"landlineNumber",areaCodeLabel:"Area Code",phoneNumberLabel:"Mobile Number",showClearIcon:!1})),r.a.createElement(l.a,{container:!0,spacing:0},r.a.createElement(l.a,{item:!0,xs:12,sm:n?6:12},r.a.createElement(s.Button,{title:"Back to Customer list",href:u.a.ACTIVE_CUSTOMERS(),buttonColor:a.palette.grey[200],classes:{text:t.cancelButtonText}})),n&&r.a.createElement(l.a,{item:!0,xs:12,sm:6},r.a.createElement(s.Button,{title:"Save changes",type:"submit",loading:e.isSubmitting,buttonColor:a.palette.primary.color2})))))})))}))},2085:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(18),o=a(28),c=a(3),l=a.n(c),s=a(998),u=a.n(s),m=a(24),d=a.n(m),b=a(2),p=a(466),f="unpaid",h="paid",C=[{id:"invoice_number",label:"Invoice number"},{id:"date_sent",label:"Date sent"},{id:"status",label:"Status"},{id:"due_date",label:"Due Date"},{id:"total_amount",label:"Total amount"}];t.a=Object(i.compose)(Object(o.withI18n)(),Object(b.withStyles)(p.a))((function(e){var t=e.classes,a=e.theme,i=e.invoices,o=e.i18n,c=Object(n.useState)(f),s=c[0],m=c[1],p=Object(n.useState)([]),v=p[0],g=p[1];return Object(n.useEffect)((function(){var e;e=l()(i,"data",[]).map((function(e){return s===h&&"FULLY_PAID"!==e.status?null:s===f&&"FULLY_PAID"===e.status?null:{id:e.id,invoice_number:l()(e,"number"),date_sent:d()(e.invoiceDate).format("DD MMM YYYY"),status:"FULLY_PAID"===e.status?"Paid":"Unpaid",due_date:d()(e.dueDate).format("DD MMM YYYY"),total_amount:o._("currency-symbol")+""+e.total}})),e=u()(e),g(e)}),[s]),r.a.createElement("div",{className:t.section},r.a.createElement(b.SectionHeader,{title:"Invoices",subtitle:"Below is a list of invoices sent to this customer.",renderLeftPart:function(){return r.a.createElement(b.Button,{title:"View "+(s===h?f:h)+" invoices",applyBorderRadius:!0,width:260,buttonColor:a.palette.primary.color2,onClick:function(){m(s===f?h:f)}})}}),r.a.createElement(b.Table,{columnData:C,data:v,sortable:!1,stripe:!1,showRemoveIcon:!1,classes:{component:t.invoiceTable}}))}))},2292:function(e,t,a){"use strict";a.r(t),function(e){var n=a(0),r=a.n(n),i=a(7),o=a.n(i),c=a(9),l=a.n(c),s=a(3),u=a.n(s),m=a(28),d=a(2),b=a(5),p=a(4),f=a.n(p),h=a(39),C=a(15),v=a(34),g=a(13),y=a(10),E=a(11),N=a(27),x=a(2084),S=a(2085),w=a(466),_=function(){return(_=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},O=function(t,a,n,r){return new(n||(n=e))((function(e,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n((function(e){e(a)}))).then(o,c)}l((r=r.apply(t,a||[])).next())}))},j=function(e,t){var a,n,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{a=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};t.default=Object(v.compose)(Object(m.withI18n)(),Object(d.withStyles)(w.a),Object(C.b)((function(e){return{profile:e.profile}})),Object(y.withUpdateCustomer)(),Object(y.withCustomer)((function(e){return{id:u()(e,"match.params.id")}})),Object(y.withInvoices)((function(e){return{variables:{where:{buyer:{id:u()(e,"match.params.id")}}}}})))((function(e){var t=e.classes,a=e.history,i=e.i18n,c=e.customer,s=e.invoices,m=e.theme,p=e.updateCustomer,C=Object(n.useState)(0),v=C[0],y=C[1],w=Object(n.useState)(!1),B=w[0],k=w[1],D=function(){var e=u()(c,"data",{}),t=u()(e,"contacts[0]")||{},a=u()(e,"addresses[0]")||{};return{id:u()(e,"id",""),name:u()(e,"name",""),govNumber:String(u()(e,"govNumber","")),contact:t,address:a}},q=function(e){var t=u()(c,"data.addresses[0]")||{},a=u()(c,"data.contacts[0]")||{},n=Boolean(a.id),r=Boolean(t.id),i={name:u()(e,"contact_name")||a.name,surname:u()(e,"contact_surname")||a.surname,email:u()(e,"email")||a.email,mobileCode:u()(e,"mobileCode")||a.mobileCode,mobileNumber:u()(e,"mobileNumber")||a.mobileNumber,landlineCode:u()(e,"landlineCode")||a.landlineCode,landlineNumber:u()(e,"landlineNumber")||a.landlineNumber};i=n?{update:[{where:{id:a.id},data:i}]}:{create:[i]};var o={street:u()(e,"street")||t.street,city:u()(e,"city")||t.city,state:u()(e,"state")||t.state,country:u()(e,"country")||t.country,postCode:u()(e,"postCode")||t.postCode};return{addresses:o=r?{update:[{where:{id:t.id},data:o}]}:{create:[o]},contacts:i}},I=function(e){return O(void 0,void 0,void 0,(function(){var t,a,n;return j(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=q(e),[4,p({data:_({name:e.customer_name,govNumber:String(e.govNumber.replace(/ /g,""))},t),where:{id:l()(c,(function(e){return e.data.id}))}})];case 1:return(a=r.sent()).success?(c.refetch(),Object(E.a)(null,"Customer updated"),k(!1)):a.error.map((function(e){return Object(E.a)(e)})),[3,3];case 2:return n=r.sent(),Object(E.a)(n.toString()),[3,3];case 3:return[2]}}))}))},T=function(e,t){return O(void 0,void 0,void 0,(function(){var a,n,r;return j(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),a=q(e),[4,p({data:a,where:{id:u()(c,"data.id")}})];case 1:return(n=i.sent()).success?(Object(E.a)(null,"Customer updated"),t.setSubmitting(!1),c.refetch()):(n.error.map((function(e){return Object(E.a)(e)})),t.setSubmitting(!1)),[3,3];case 2:return r=i.sent(),Object(E.a)(r.toString()),[3,3];case 3:return[2]}}))}))};return r.a.createElement(N.a,{onChange:function(){a.push(b.a.CUSTOMERS())}},r.a.createElement("div",{className:t.page},r.a.createElement(d.Tabs,{tabs:[{label:"All Customers",onClick:function(){a.push(b.a.ACTIVE_CUSTOMERS())}},{label:"Archived",onClick:function(){a.push(b.a.ARCHIVED_CUSTOMERS())}}],tabTheme:"secondary",activeIndex:!1}),r.a.createElement("div",{className:t.content},function(){var e=D(),a=e.name,n=e.contact,c=e.govNumber,l=u()(s,"data",[]).reduce((function(e,t){return"FULLY_PAID"===t.status?e+t.total:e}),0),m=u()(s,"data",[]).reduce((function(e,t){return"FULLY_PAID"!==t.status?e+t.total:e}),0);return r.a.createElement("div",{className:t.detailsCardsWrapper},r.a.createElement(f.a,{container:!0,spacing:8},r.a.createElement(f.a,{item:!0,xs:12,sm:5},r.a.createElement("div",{className:t.detailCard},r.a.createElement("div",{className:o()(t.detailCardHeader,"green h1")},a),r.a.createElement("div",{className:o()(t.detailCardContent,"withBG h2")},r.a.createElement("div",{className:t.keyValue},n.name," ",n.surname),r.a.createElement("div",{className:t.keyValue},i._("ABN")," ",c),r.a.createElement("div",{className:t.keyValue},n.email),r.a.createElement("div",{className:t.editButton,onClick:function(){k(!0)}},r.a.createElement("i",{className:"ion-edit"}))))),r.a.createElement(f.a,{item:!0,xs:12,sm:2},r.a.createElement("div",{className:t.detailCard},r.a.createElement("div",{className:o()(t.detailCardHeader,"blue h2")},"Status"),r.a.createElement("div",{className:o()(t.detailCardContent,"h1")},"-"))),r.a.createElement(f.a,{item:!0,xs:12,sm:3},r.a.createElement("div",{className:t.detailCard},r.a.createElement("div",{className:o()(t.detailCardHeader,"black h2")},"Total money made"),r.a.createElement("div",{className:o()(t.detailCardContent,"h1")},i._("currency-symbol"),l))),r.a.createElement(f.a,{item:!0,xs:12,sm:2},r.a.createElement("div",{className:t.detailCard},r.a.createElement("div",{className:o()(t.detailCardHeader,"black h2")},"Owed"),r.a.createElement("div",{className:o()(t.detailCardContent,"h1")},i._("currency-symbol"),m)))))}(),r.a.createElement(f.a,{container:!0,spacing:0},r.a.createElement(f.a,{item:!0,xs:12,sm:3},r.a.createElement(d.ToggleButton,{labels:["Details","Invoices"],selectedIndex:0,activeColor:m.palette.primary.color1,onChange:function(e,t){y(t)}}))),0===v&&function(){var e=D();return r.a.createElement(x.a,{customer:e,onSubmit:T})}(),1===v&&r.a.createElement(S.a,{invoices:s})),function(){var e=D(),a=e.name,n=e.govNumber,o=e.contact;return r.a.createElement(d.Modal,{visible:B,onClose:function(){k(!1)},classes:{description:t.editCompanyModalDescription},title:"Edit Customer Details",description:r.a.createElement(h.Formik,{enableReinitialize:!0,initialValues:{customer_name:a,contact_name:o.name,contact_surname:o.surname,govNumber:n,email:o.email},validationSchema:g.object().shape({customer_name:g.string().required("Name is required"),contact_name:g.string().required("Contact name is required"),contact_surname:g.string().required("Surname is required"),govNumber:g.string().required(i._("ABN")+" is required"),email:g.string().required("Email is required").required("Invalid Email")}),onSubmit:I},(function(e){var a=e.dirty;return r.a.createElement("form",{className:t.modalForm,onSubmit:e.handleSubmit},r.a.createElement(f.a,{container:!0,spacing:0,classes:{container:t.formFields}},r.a.createElement(f.a,{item:!0,xs:12,sm:12},r.a.createElement(d.CustomerForm,{keys:{customer_name:"customer_name",contact_name:"contact_name",contact_surname:"contact_surname",abn:"govNumber",email:"email"},labels:{customer_name:"Customer Name",contact_name:"Contact Name",contact_surname:"Contact Surname",abn:i._("ABN"),email:"Email"}}))),r.a.createElement(f.a,{container:!0,spacing:0},r.a.createElement(f.a,{item:!0,xs:12,sm:a?6:12},r.a.createElement(d.Button,{title:"Cancel and go back",onClick:function(){k(!1)},buttonColor:m.palette.grey[200],classes:{text:t.cancelButtonText,component:t.modalCancelBtn}})),a&&r.a.createElement(f.a,{item:!0,xs:12,sm:6},r.a.createElement(d.Button,{title:"Save changes",buttonColor:m.palette.primary.color2,type:"submit",classes:{component:t.modalSaveBtn}}))))}))})}()))}))}.call(this,a(21))},27:function(e,t,a){"use strict";var n=a(0),r=a(18),i=a(15),o=a(317),c=a(9),l=a.n(c);t.a=Object(r.compose)(Object(i.b)((function(e){return{selectedCompany:l()(e,(function(e){return e.profile.selectedCompany}))}})))((function(e){var t=e.selectedCompany,a=e.onChange,r=e.children;return Object(o.a)((function(){a(t)}),[t]),n.createElement(n.Fragment,null,r)}))},317:function(e,t,a){"use strict";var n=a(30),r=a.n(n),i=a(0);function o(e){var t,a,n=Object(i.useRef)();return t=e,a=n.current,r()(t,a)||(n.current=e),n.current}t.a=function(e,t){Object(i.useEffect)(e,o(t))}},466:function(e,t,a){"use strict";t.a=function(e){return{page:{flex:1,display:"flex",flexDirection:"column"},content:{padding:"40px 20px 0px",flex:1},cancelButtonText:{color:e.palette.primary.color3},detailsCardsWrapper:{marginBottom:30},detailCard:{alignSelf:"stretch",height:"100%",flex:1,display:"flex",flexDirection:"column",fontFamily:e.typography.font.family2,position:"relative",color:e.palette.blueGrey[50]},detailCardHeader:{borderTopRightRadius:5,borderTopLeftRadius:5,padding:"0px 20px",color:"white",fontWeight:"bold",height:70,display:"flex",alignItems:"center","&.green":{backgroundColor:e.palette.primary.color1},"&.h1":{fontSize:26},"&.h2":{fontSize:16},"&.blue":{backgroundColor:e.palette.primary.color2},"&.black":{backgroundColor:e.palette.primary.color3}},detailCardContent:{padding:"10px 20px",borderBottomRightRadius:5,borderBottomLeftRadius:5,flex:1,border:"1px solid "+e.palette.grey[200],display:"flex",justifyContent:"center",flexDirection:"column","&.withBG":{backgroundColor:e.palette.grey[100],border:0},"&.h1":{fontSize:20},"&.h2":{fontSize:16}},keyValue:{marginBottom:5},editButton:{position:"absolute",bottom:10,right:10,fontSize:20,cursor:"pointer"},section:{marginTop:30},detailsForm:{marginTop:30},formHeading:{marginBottom:20},invoiceTable:{marginTop:20},detailsModal:{backgroundColor:"rgba(0,0,0,0.5)",position:"fixed",top:0,bottom:0,left:0,right:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},editCompanyModalDescription:{padding:0},modalForm:{padding:0,paddingTop:0},formFields:{padding:20},detailsModalContent:{backgroundColor:"white",borderRadius:5,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",maxWidth:900},modalCancelBtn:{borderBottomLeftRadius:5,padding:"20px 10px"},modalSaveBtn:{borderBottomRightRadius:5,padding:"20px 10px"}}}}}]);