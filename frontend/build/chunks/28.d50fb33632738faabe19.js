(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{11:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r(652),n=function(e,t){void 0===e&&(e=""),void 0===t&&(t="");var r=e?"error":"success",n=e||t;Object(o.b)(n,{type:r,closeButton:!1,hideProgressBar:!0})}},2290:function(e,t,r){"use strict";r.r(t);var o,n=r(0),s=r.n(n),c=r(4),i=r.n(c),a=r(2),u=r(5),l=r(639),p=r(474),m=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),h=function(){return(h=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._showDeleteAllCustomerDialog=function(){var e=t.props,r=e.history,o=e.theme,n=s.a.createElement("div",null,s.a.createElement("div",null,"You are trying to permanently delete all archived customers from this account. This action is not reversable."),s.a.createElement("br",null),s.a.createElement("div",null,"Are you sure you want to delete all archived customers?")),c=[{title:"Cancel",type:"cancel",onClick:function(){t.props.actions.closeAlertDialog()}},{title:"Delete All",buttonColor:o.palette.secondary.color2,onClick:function(){t.props.actions.closeAlertDialog(),r.push(u.a.ACTIVE_CUSTOMERS())}}],i=o.palette.secondary.color2;t.props.actions.showAlertDialog({title:"Permanently delete all archived customers?",description:n,buttons:c,titleColor:i})},t._showDeleteCustomerDialog=function(e){var r=t.props.theme,o=s.a.createElement("div",null,s.a.createElement("div",null,"You are trying to permanently delete a customer from this account. This action is not reversable."),s.a.createElement("br",null),s.a.createElement("div",null,"Are you sure you want to delete this customer?")),n=[{title:"Cancel",type:"cancel",onClick:function(){t.props.actions.closeAlertDialog()}},{title:"Delete Customer",buttonColor:r.palette.secondary.color2,onClick:function(){t.props.actions.closeAlertDialog(),t.props.onRemoveCustomer(e)}}],c=r.palette.secondary.color2;t.props.actions.showAlertDialog({title:"Permanently delete customer?",description:o,buttons:n,titleColor:c})},t._showActivateCustomerDialog=function(e){var r=t.props.theme,o=s.a.createElement("div",null,s.a.createElement("div",null,"You are trying to activate a customer from the archived list. This will add the customer to your customers list."),s.a.createElement("br",null),s.a.createElement("div",null,"Are you sure you want to activate this customer?")),n=[{title:"Cancel",type:"cancel",onClick:function(){t.props.actions.closeAlertDialog()}},{title:"Activate customer",onClick:function(){t.props.actions.closeAlertDialog(),t.props.onUnarchiveCustomer(e)}}],c=r.palette.primary.color2;t.props.actions.showAlertDialog({title:"Activate customer?",description:o,buttons:n,titleColor:c})},t}return m(t,e),t.prototype._renderSectionHeading=function(){var e=this,t=this.props.theme;return s.a.createElement(a.SectionHeader,{title:"Archived customers",subtitle:"Below is a list of all archived customers. Activate a customer by selecting from the list below.",renderLeftPart:function(){return s.a.createElement(a.Button,{title:"Delete list permanently",applyBorderRadius:!0,width:260,buttonColor:t.palette.secondary.color2,onClick:e._showDeleteAllCustomerDialog})}})},t.prototype._renderCustomers=function(){var e=this.props,t=e.classes,r=e.customers,o=e.columns,n=e.onSortRequested,c=e.onSearchCustomer;return s.a.createElement("div",{className:t.customersContainer},s.a.createElement(i.a,{item:!0,xs:12,sm:6},s.a.createElement(a.SearchInput,{classes:{component:t.searchInput},placeholder:"Search by typing a company name",items:[],onSearch:c})),s.a.createElement(a.Table,{columnData:o,data:r,sortable:!0,stripe:!1,showAddIcon:!0,onRequestSort:n,onRemoveClicked:this._showDeleteCustomerDialog,onAddClicked:this._showActivateCustomerDialog,cellStyler:function(e,r){return"money_made"===r.id?t.greenCell:""}}))},t.prototype.render=function(){var e=this.props.classes;return s.a.createElement(a.ErrorBoundary,null,s.a.createElement("div",{className:e.tabContent},this._renderSectionHeading(),this._renderCustomers()))},t}(n.Component),f=Object(a.withStyles)(Object(a.composeStyles)(p.b,p.a))(d);t.default=function(e){return s.a.createElement(l.a,h({},e,{type:"archived-customers"}),(function(e){return s.a.createElement(f,h({},e))}))}},27:function(e,t,r){"use strict";var o=r(0),n=r(18),s=r(15),c=r(317),i=r(9),a=r.n(i);t.a=Object(n.compose)(Object(s.b)((function(e){return{selectedCompany:a()(e,(function(e){return e.profile.selectedCompany}))}})))((function(e){var t=e.selectedCompany,r=e.onChange,n=e.children;return Object(c.a)((function(){r(t)}),[t]),o.createElement(o.Fragment,null,n)}))},317:function(e,t,r){"use strict";var o=r(30),n=r.n(o),s=r(0);function c(e){var t,r,o=Object(s.useRef)();return t=e,r=o.current,n()(t,r)||(o.current=e),o.current}t.a=function(e,t){Object(s.useEffect)(e,c(t))}},474:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),t.b=function(e){return{page:{flex:1,display:"flex",flexDirection:"column"}}};var o=function(e){return{tabContent:{padding:"40px 20px",flex:1,display:"flex",flexDirection:"column"},noCustomersWrapper:{flex:1,alignItems:"center",justifyContent:"center",display:"flex",margin:"50px 0px"},noCustomerMessageWrapper:{width:"60%",maxWidth:660,margin:"0px auto",border:"4px dashed "+e.palette.grey[300],padding:10,borderRadius:20,minHeight:200,backgroundColor:e.palette.grey[100],alignItems:"center",justifyContent:"center",display:"flex"},noCustomerMessage:{fontFamily:e.typography.font.family1,fontSize:26,lineHeight:"35px",fontWeight:"500",color:e.palette.blueGrey[50],textAlign:"center"},customersContainer:{marginTop:"20px !important"},searchInput:{margin:"30px 0px"},customerNameCell:{fontFamily:e.typography.font.family2,color:e.palette.primary.color2,cursor:"pointer",fontWeight:500},greenCell:{color:e.palette.primary.color1,fontWeight:"bold"},orangeCell:{color:e.palette.secondary.color1,fontWeight:"bold"},pagination:{marginTop:20}}}},639:function(e,t,r){"use strict";(function(e){var o,n=r(0),s=r.n(n),c=r(9),i=r.n(c),a=r(30),u=r.n(a),l=r(35),p=r.n(l),m=r(34),h=r(15),d=r(10),f=r(27),y=r(11),v=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),b=function(t,r,o,n){return new(o||(o=e))((function(e,s){function c(e){try{a(n.next(e))}catch(e){s(e)}}function i(e){try{a(n.throw(e))}catch(e){s(e)}}function a(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(c,i)}a((n=n.apply(t,r||[])).next())}))},C=function(e,t){var r,o,n,s,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,o=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(n=(n=c.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){c=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){c.label=s[1];break}if(6===s[0]&&c.label<n[1]){c.label=n[1],n=s;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(s);break}n[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},w=function(e){function t(t){var r=e.call(this,t)||this;return r._onSortRequested=function(e){return b(r,void 0,void 0,(function(){var t,r,o,n,s;return C(this,(function(c){switch(c.label){case 0:return t=this.state.columns,r=p()(t,{sorted:!0}),o=p()(t,{id:e.id}),n="asc",r.id===o.id&&"asc"===r.order&&(n="desc"),s={orderBy:o.id+"_"+n.toUpperCase()},[4,this.props.customers.refetch(s)];case 1:return c.sent(),r.sorted=!1,o.sorted=!0,o.order=n,this.setState({columns:t}),[2]}}))}))},r._onArchiveCustomer=function(e){return b(r,void 0,void 0,(function(){var t,r;return C(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.props.archiveCustomer({where:{id:e.id},data:{isArchived:!0}})];case 1:return(t=o.sent()).success?(Object(y.a)(null,"Customer archived successfully"),this.props.customers.refetch()):t.error((function(e){return Object(y.a)(e)})),[3,3];case 2:throw r=o.sent(),Object(y.a)("Something went wrong"),new Error(r);case 3:return[2]}}))}))},r._onUnarchiveCustomer=function(e){return b(r,void 0,void 0,(function(){var t,r;return C(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.props.unArchiveCustomer({where:{id:e.id},data:{isArchived:!1}})];case 1:return(t=o.sent()).success?(Object(y.a)(null,"Customer activated successfully"),this.props.customers.refetch()):t.error((function(e){return Object(y.a)(e)})),[3,3];case 2:throw r=o.sent(),Object(y.a)("Something went wrong"),new Error(r);case 3:return[2]}}))}))},r._onRemoveCustomer=function(e){return b(r,void 0,void 0,(function(){var t,r;return C(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.props.deleteCustomer({where:{id:e.id}})];case 1:return(t=o.sent()).success?(Object(y.a)(null,"Customer deleted successfully"),this.props.customers.refetch()):t.error((function(e){return Object(y.a)(e)})),[3,3];case 2:throw r=o.sent(),Object(y.a)("Something went wrong"),new Error(r);case 3:return[2]}}))}))},r._searchCustomer=function(e){return b(r,void 0,void 0,(function(){return C(this,(function(t){return this.props.customers.refetch({where:{name_contains:e||void 0}}),[2]}))}))},r.state={displayedCustomers:i()(t,(function(e){return e.customers.data})),columns:[{id:"name",label:"Customer name",sorted:!0,order:"asc"},{id:"email",label:"Email"},{id:"projects",label:"Projects"},{id:"money_made",label:"Money Made"},{id:"money_owed",label:"Money Owed"}]},r}return v(t,e),t.prototype.componentDidUpdate=function(e){var t=i()(e,(function(e){return e.customers.data}))||[],r=i()(this.props,(function(e){return e.customers.data}))||[];u()(t,r)||this._updateCustomers(r)},t.prototype._updateCustomers=function(e){this.setState({displayedCustomers:e})},t.prototype.render=function(){var e=this.state,t=e.displayedCustomers,r=e.columns,o=this.props,n=o.match,c=o.history,i=o.location,a=o.actions,u=o.customers,l=void 0===u?{}:u;return s.a.createElement(f.a,{onChange:l.refetch},this.props.children({match:n,history:c,location:i,actions:a,customers:t,columns:r,onSortRequested:this._onSortRequested,onArchiveCustomer:this._onArchiveCustomer,onUnarchiveCustomer:this._onUnarchiveCustomer,onRemoveCustomer:this._onRemoveCustomer,onSearchCustomer:this._searchCustomer}))},t}(n.Component);t.a=Object(m.compose)(Object(h.b)((function(e){return{profile:e.profile}})),Object(d.withCustomers)((function(e){e.profile;var t=!1;return"archived-customers"===e.type&&(t=!0),{variables:{where:{isArchived:t},orderBy:"name_ASC"}}})),Object(d.withDeleteCustomer)(),Object(d.withUpdateCustomer)((function(){return{name:"archiveCustomer"}})),Object(d.withUpdateCustomer)((function(){return{name:"unArchiveCustomer"}})))(w)}).call(this,r(21))}}]);