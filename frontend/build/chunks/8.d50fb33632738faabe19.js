(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{11:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(652),a=function(e,t){void 0===e&&(e=""),void 0===t&&(t="");var n=e?"error":"success",a=e||t;Object(r.b)(a,{type:n,closeButton:!1,hideProgressBar:!0})}},2165:function(e,t,n){"use strict";var r,a=n(0),o=n.n(a),i=n(18),s=n(2),c=n(10),l=n(218),u=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={emails:[]},t._sendTimesheetApproveEmail=function(){for(var e=t.props.timesheets,n=t.state.emails,r=0;r<e.length;r++){var a=e[r];t.props.timeSheetApprove({timeSheetId:a,to:n.map((function(e){return e.email}))})}t.props.onClose()},t}return u(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.classes,r=t.onClose,a=t.visible,i=this.state.emails;return o.a.createElement(s.Modal,{visible:a,onClose:r,title:"Ready to submit for approval",description:o.a.createElement("div",null,o.a.createElement("div",null,"Your timesheet is now finalised. It will now be submitted for Approval."),o.a.createElement("br",null),o.a.createElement("div",null,"Please add emails"),o.a.createElement(s.EmailInputFields,{classes:{component:n.emailInputs},showBCC:!1,showCC:!1,onEmailChange:function(t){e.setState({emails:t.to})}})),buttons:[{title:"Submit",isDisabled:i.length<=0,onClick:this._sendTimesheetApproveEmail}]})},t.defaultProps={timesheets:[],onClose:function(){}},t}(a.Component);t.a=Object(i.compose)(Object(s.withStyles)(l.a),Object(c.withTimeSheetApprove)())(d)},2166:function(e,t,n){"use strict";(function(e){var r,a=n(0),o=n(18),i=n(2),s=n(10),c=n(479),l=n.n(c),u=n(2167),d=n(218),p=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),h=function(){return(h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},f=function(t,n,r,a){return new(r||(r=e))((function(e,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,s)}c((a=a.apply(t,n||[])).next())}))},m=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onAddNewTimesheetRow=function(){var e=t.props.timesheetRows,n=h({},e);n[l.a.v4()]={},t.props.onUpdateRows({timesheetRows:n})},t._onTimeSheetRowUpdate=function(e){return function(n){var r=t.props.timesheetRows,a=h({},r);a[e]=h(h({},a[e]||{}),n),t.props.onUpdateRows({timesheetRows:a})}},t._onRemoveTimesheetRow=function(e){return function(){var n=t.props,r=n.timesheetRows,o=n.theme,i=n.actions,s=n.updateTimeSheet,c=n.timeSheetId,l=n.onUpdateRows,u=h({},r),d=u[e]||{};if(d.entries){var p=a.createElement("div",null,a.createElement("div",null,"Are you sure you want to remove this entries?")),y=[{title:"Cancel",type:"cancel",onClick:function(){i.closeAlertDialog()}},{title:"Remove",buttonColor:o.palette.secondary.color2,onClick:function(){return f(t,void 0,void 0,(function(){var t;return m(this,(function(n){switch(n.label){case 0:return i.closeAlertDialog(),t=Object.values(d.entries).map((function(e){return{id:e.id}})),[4,s({where:{id:c},data:{timeSheetEntries:{delete:t}}})];case 1:return n.sent(),delete u[e],l({timesheetRows:u}),[2]}}))}))}}],v=o.palette.primary.color2;t.props.actions.showAlertDialog({title:"Remove timesheet row?",description:p,buttons:y,titleColor:v})}else delete u[e],l({timesheetRows:u})}},t}return p(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.classes,r=t.theme,o=t.projects,s=t.customers,c=t.services,l=t.allowedToEdit,d=t.timesheetRows,p=t.currentWeekPeriod,h=Object.keys(d||{}).length;return a.createElement("div",{className:n.inputs},Object.keys(d).map((function(t,n){return a.createElement(u.a,{key:t,hideRemoveIcon:1===h,hideDaysLabel:n>0,startWeekDay:p.startWeekDay,endWeekDay:p.endWeekDay,projects:o,customers:s,services:c,initialData:d[t],onChange:e._onTimeSheetRowUpdate(t),onRemoveClick:e._onRemoveTimesheetRow(t),allowedToEdit:l})})),l&&a.createElement("span",{"data-html2canvas-ignore":!0},a.createElement(i.Button,{title:"New Row",applyBorderRadius:!0,width:200,compactMode:!0,buttonColor:r.palette.primary.color2,classes:{component:n.newRowButton},onClick:this._onAddNewTimesheetRow})))},t.defaultProps={timesheetRows:{}},t}(a.Component);t.a=Object(o.compose)(Object(i.withStyles)(d.b),Object(s.withUpdateTimeSheet)())(y)}).call(this,n(21))},2167:function(e,t,n){"use strict";var r,a=n(0),o=n.n(a),i=n(7),s=n.n(i),c=n(24),l=n.n(c),u=n(30),d=n.n(u),p=n(3),h=n.n(p),f=n(71),m=n.n(f),y=n(961),v=n.n(y),b=n(1004),w=n.n(b),g=n(31),E=n.n(g),D=n(2),S=n(25),_=n(11),T=n(218),k=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),P=function(){return(P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},C=function(e){function t(t){var n=e.call(this,t)||this;return n._updateUsingInitialData=function(e){E()(e)||n.setState({selectedBtn:e.selectedBtn,selectedService:e.selectedService,selectedProjectCustomer:e.selectedProjectCustomer,dayHours:e.dayHours})},n._calculateRangeOfDates=function(e,t){var r=D.helpers.getRangeDates(e,t);n.setState({dates:r})},n._changeSelectedButton=function(e){return function(t){n.setState({selectedBtn:e,selectedProjectCustomer:null,selectedService:null,dayHours:{}},(function(){n._onChange()}))}},n._checkDirty=function(){var e=n.state,t=e.selectedBtn,r=e.selectedService,a=e.selectedProjectCustomer,o=e.dayHours;return!d()(n.initialInputState,{selectedBtn:t,selectedService:r,selectedProjectCustomer:a,dayHours:o})},n._onChange=function(){var e=n.state,t=e.dayHours,r=e.selectedProjectCustomer,a=e.selectedService,o=e.selectedBtn;n.props.onChange({dayHours:t,selectedProjectCustomer:r,selectedService:a,selectedType:0===o?"project":"customer",selectedBtn:o})},n._onDayHourChange=function(e,t){var r=n.state,a=r.dayHours,o=r.selectedService,i=h()(o,"timeBasedType","HOUR")||"",s=24,c=25,l=24;"DAY"===i&&(s=1.9,c=2,l=1),t?parseFloat(t)>s?(Object(_.a)("You are trying to add the number "+t+". The service you are using has been predefined as a '"+i+"' unit. A "+i.toLowerCase()+" is represented as the number "+l+". Please insert a number that results to below "+c+"."),a[e]=t.substr(0,t.length-1)):a[e]=t:delete a[e],n.setState({dayHours:a},(function(){n._checkDirty(),n._onChange()}))},n._onDayHourBlur=function(e){var t=n.state.dayHours,r=t[e];null!=r&&(t[e]=v()(r,2),n.setState({dayHours:t},(function(){n._checkDirty(),n._onChange()})))},n._onSelectionChange=function(e){return function(t,r){var a,o=((a={})[e]=t.value,a.dayHours={},a);"selectedProjectCustomer"===e&&(o=P(P({},o),{selectedService:null})),n.setState(o,(function(){n._checkDirty(),n._onChange()}))}},n.initialInputState={selectedBtn:0,selectedService:{},selectedProjectCustomer:{},dayHours:{}},n.state=P({dates:[]},n.initialInputState),n}return k(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.startWeekDay,n=e.endWeekDay;t&&n&&this._calculateRangeOfDates(t,n),this._updateUsingInitialData(this.props.initialData)},t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.startWeekDay,r=t.endWeekDay,a=t.initialData;e.startWeekDay===n&&e.endWeekDay===r||this._calculateRangeOfDates(this.props.startWeekDay,this.props.endWeekDay),d()(a,e.initialData)||this._updateUsingInitialData(this.props.initialData)},t.prototype._renderInputWrapper=function(){var e=this,t=this.props,n=t.classes,r=t.hideRemoveIcon,a=t.onRemoveClick,i=t.hideDaysLabel,s=t.allowedToEdit,c=this.state,u=c.dates,d=c.dayHours,p=c.selectedService,f="h";"DAY"===h()(p,"timeBasedType")&&(f="d");var m=0;return w()(d,(function(e,t){m+=parseFloat(e)||0})),m=v()(m,2),o.a.createElement("div",{className:n.inputWrapper},u.map((function(t,r){var a=l()(t),c=a.format("YYYY-MM-DD");return o.a.createElement("div",{className:n.dayWrapper,key:r},!i&&o.a.createElement("div",{className:n.dayInitial},a.format("dd")),!i&&o.a.createElement("div",{className:n.dayNumber},a.format("DD")),o.a.createElement("div",{className:n.dayInput},o.a.createElement(D.TextField,{showClearIcon:!1,isNumber:!0,placeholder:"0",id:"hour-input-"+r,classes:{textInputWrapper:n.dayInputWapper,textInput:n.dayInputField},value:""+(d[c]||""),onChangeText:function(t){e._onDayHourChange(c,t)},onBlur:function(t){e._onDayHourBlur(c)},isReadOnly:!s})))})),o.a.createElement("div",{className:n.dayWrapper},!i&&o.a.createElement("div",{className:n.totalLabel},"Total"),o.a.createElement("div",{className:n.totalHoursWrapper},o.a.createElement("div",{className:n.totalHours,"data-test":"total-hours-"+m},m),o.a.createElement("div",{className:n.hoursSymbol},f))),!r&&s&&o.a.createElement("div",{className:n.removeIcon,onClick:a},o.a.createElement("i",{className:"icon icon-close"})))},t.prototype.render=function(){var e=this.props,t=e.classes,n=e.projects,r=e.customers,a=e.services,i=e.allowedToEdit,c=this.state,l=c.selectedBtn,u=c.selectedProjectCustomer,d=c.selectedService,p=[],f=[],y="";0===l?(y="Select a project",p=n.data.map((function(e){return{label:e.name,value:e}})),E()(u)||(f=h()(u,"projectService",[]).filter((function(e){return h()(e,"service.billingType")===S.f.TIME_BASED})).map((function(e){return{label:e.service.name,value:e.service}})))):1===l&&(y="Select a customer",p=r.data.map((function(e){return{label:e.name,value:e}})),f=a.data.map((function(e){return{label:e.name,value:e}})));return o.a.createElement("div",{className:t.wrapper},o.a.createElement("div",{className:t.selectionWrapper},o.a.createElement("div",{onClick:this._changeSelectedButton(0),className:s()(t.selectBtn,t.projectBtn,{active:0===l,disabled:!i})},o.a.createElement("i",{className:"icon icon-projects"})),o.a.createElement("div",{onClick:this._changeSelectedButton(1),className:s()(t.selectBtn,t.userBtn,{active:1===l,disabled:!i})},o.a.createElement("i",{className:"icon icon-user-account"})),o.a.createElement(D.Dropdown,{id:"timesheet-project-customer",classes:{component:t.pDropdown,select:t.pDropdownSelect,menuItemText:t.dropdownItemText},onChange:this._onSelectionChange("selectedProjectCustomer"),placeholder:y,items:p,value:u,comparator:function(e,t){if(t&&t.id){var n=m()(e,{id:t.id});return{index:n,item:e[n]}}return{index:void 0}},disabled:!i}),o.a.createElement(D.Dropdown,{id:"timesheet-service",classes:{component:t.sDropdown,select:t.sDropdownSelect,menuItemText:t.dropdownItemText},onChange:this._onSelectionChange("selectedService"),placeholder:"Select a service",items:f,value:d||{},comparator:function(e,t){if(t&&t.id){var n=m()(e,{id:t.id});return{index:n,item:e[n]}}return{index:void 0}},disabled:!i})),this._renderInputWrapper())},t.defaultProps={onRemoveClick:function(){},onChange:function(){},hideRemoveIcon:!1,hideDaysLabel:!1},t}(a.Component);t.a=Object(D.withStyles)(T.c)(C)},2170:function(e,t,n){"use strict";(function(e){var r,a=n(0),o=n.n(a),i=n(18),s=n(2),c=n(10),l=n(251),u=n(11),d=n(218),p=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),h=function(){return(h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},f=function(t,n,r,a){return new(r||(r=e))((function(e,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,s)}c((a=a.apply(t,n||[])).next())}))},m=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._removeAttachment=function(e,n){return f(t,void 0,void 0,(function(){var t,r,a,o,i;return m(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),t=this.props,r=t.attachedFiles,a=t.deleteAttachment,o=t.onUpdateAttachments,e.id?[4,a({where:{id:e.id}})]:[3,2];case 1:s.sent(),s.label=2;case 2:return r.splice(n,1),o({attachedFiles:r}),[3,4];case 3:return i=s.sent(),Object(u.a)(i.toString()),[3,4];case 4:return[2]}}))}))},t}return p(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.classes,r=t.allowedToEdit,a=t.attachedFiles,i=t.onUpdateAttachments,c={};return a.length<=0&&(c={"data-html2canvas-ignore":!0}),!r&&a.length<=0?null:o.a.createElement("div",h({className:n.attachementWrapper},c),o.a.createElement(s.FieldLabel,{label:"Attachments"}),o.a.createElement(l.default,{multiple:!0,className:n.dragAreaWrapper,activeClassName:n.activeDragArea,onDropAccepted:function(e){i({attachedFiles:[].concat(a,e)})}},o.a.createElement("div",{className:n.attachementBlock},o.a.createElement("div",{className:n.attachedFilesBlock},a.map((function(t,n){return o.a.createElement(s.FileBlock,{key:n,file:t instanceof File?t:h(h({},t),{name:t.fileName}),variant:"interactive",onRemoveClick:function(r){r.stopPropagation(),e._removeAttachment(t,n)}})}))),r&&o.a.createElement("div",{className:n.dragArea,"data-html2canvas-ignore":!0},o.a.createElement("div",{className:n.dragText},"Drag files here or Browse")))))},t}(a.Component);t.a=Object(i.compose)(Object(s.withStyles)(d.b),Object(c.withDeleteAttachment)())(y)}).call(this,n(21))},2171:function(e,t,n){"use strict";var r,a=n(0),o=n(18),i=n(140),s=n.n(i),c=n(4),l=n.n(c),u=n(2),d=n(24),p=n.n(d),h=n(218),f=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=function(){return(m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currentYear=p()().year(),t.currentMonth=p()().month(),t.yearList=s()(t.currentYear-2,t.currentYear+10).map((function(e){return{label:String(e),value:e}})),t.monthList=s()(0,12).map((function(e){return{label:p()().month(e).format("MMMM"),value:e}})),t._getWeekNumberFromMonth=function(e,t){return p()().month(e).year(t).date(1).week()},t}return f(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.classes,r=t.currentWeekPeriod,o=t.onWeekPeriodChange,i=t.onUpdateCurrentWeekPeriod;return a.createElement("div",{className:n.periodSelectionWrapper},a.createElement(l.a,{container:!0,justify:"space-between",spacing:0},a.createElement(l.a,{item:!0,xs:12,sm:6},a.createElement(l.a,{container:!0,spacing:16},a.createElement(l.a,{item:!0,xs:12,sm:6},a.createElement(u.Dropdown,{label:"Month",items:this.monthList,value:r.month,onChange:function(t){var n=e._getWeekNumberFromMonth(t.value,r.year);i(m(m({},r),{month:t.value,week:n}))}})),a.createElement(l.a,{item:!0,xs:12,sm:6},a.createElement(u.Dropdown,{label:"Year",items:this.yearList,value:r.year,onChange:function(e){i(m(m({},r),{year:e.value}))}})))),a.createElement(l.a,{item:!0,xs:12,sm:6},a.createElement(l.a,{container:!0,justify:"flex-end"},a.createElement(l.a,{item:!0,xs:12,sm:8},a.createElement(u.WeekPeriod,{year:r.year,week:r.week,onWeekChange:o}))))))},t.defaultProps={},t}(a.Component);t.a=Object(o.compose)(Object(u.withStyles)(h.b))(y)},218:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),t.b=function(e){return{page:{flex:1,display:"flex",flexDirection:"column"},content:{padding:"40px 10px",flex:1,display:"flex",flexDirection:"column"},sectionHeader:{padding:"0px 10px"},pdfContent:{padding:"10px"},periodSelectionWrapper:{margin:"20px 0px"},inputs:{marginTop:50},newRowButton:{marginTop:20},cancelButtonText:{color:e.palette.grey[500]},attachementWrapper:{marginTop:15},attachedFilesBlock:{display:"flex",alignItems:"center",flexWrap:"wrap"},attachementBlock:{border:"2px dashed "+e.palette.primary.color2,borderRadius:5},dragAreaWrapper:{width:"auto",height:"auto",border:"0px",cursor:"pointer"},activeDragArea:{backgroundColor:e.palette.grey[100]},dragText:{fontFamily:e.typography.font.family2,fontSize:17,fontWeight:"500",color:e.palette.primary.color2,padding:"20px 10px",textAlign:"center"},finaliseDesc:{textAlign:"center"}}};var r=function(e){return{wrapper:{flexDirection:"row",display:"flex",alignItems:"center"},selectionWrapper:{flexDirection:"row",display:"flex",alignItems:"center",marginTop:function(e){return e.hideDaysLabel?10:50},marginRight:15,flex:1},selectBtn:{padding:"0px 0px",height:50,minWidth:58,display:"flex",alignItems:"center",justifyContent:"center",fontSize:25,cursor:"pointer",color:e.palette.primary.color2,border:"1px solid "+e.palette.grey[300],"&.active":{backgroundColor:e.palette.primary.color1,color:"white"},"&.disabled":{cursor:"not-allowed",pointerEvents:"none"}},projectBtn:{borderTopLeftRadius:5,borderBottomLeftRadius:5},userBtn:{borderLeft:0},pDropdown:{minWidth:200},pDropdownSelect:{borderRadius:0,borderLeft:0,borderRight:0},sDropdown:{minWidth:200},sDropdownSelect:{borderTopLeftRadius:0,borderBottomLeftRadius:0},dropdownItemText:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},inputWrapper:{flexDirection:"row",display:"flex",alignItems:"flex-end",marginTop:function(e){return e.hideDaysLabel?10:0}},dayWrapper:{flexDirection:"column",display:"flex",alignItems:"center"},dayInitial:{color:e.palette.blueGrey[50],fontSize:15,marginBottom:5,fontFamily:e.typography.font.family2},dayNumber:{color:e.palette.primary.color1,fontSize:16,marginBottom:10,fontFamily:e.typography.font.family2,fontWeight:"bold"},dayInput:{width:60},dayInputWapper:{borderRadius:0,borderRightWidth:0,"$dayWrapper:first-child &":{borderTopLeftRadius:5,borderBottomLeftRadius:5}},dayInputField:{textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"},totalLabel:{color:e.palette.blueGrey[50],fontFamily:e.typography.font.family2,fontSize:16,fontWeight:"bold",marginBottom:10},totalHoursWrapper:{backgroundColor:e.palette.primary.color1,padding:"0px 15px",height:52,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",borderTopRightRadius:5,borderBottomRightRadius:5,minWidth:50},totalHours:{color:"white",fontFamily:e.typography.font.family2,fontSize:16,marginRight:5,fontWeight:"500"},hoursSymbol:{color:e.palette.shadow.color1,fontFamily:e.typography.font.family2,fontSize:16,fontWeight:"bold"},removeIcon:{padding:"0px 15px",cursor:"pointer",color:e.palette.blueGrey[50],height:50,display:"flex",alignItems:"center"}}},a=function(e){return{emailInputs:{marginTop:15}}}},2322:function(e,t,n){"use strict";n.r(t),function(e){var r,a=n(0),o=n.n(a),i=n(4),s=n.n(i),c=n(18),l=n(15),u=n(24),d=n.n(u),p=n(3),h=n.n(p),f=n(160),m=n.n(f),y=n(132),v=n.n(y),b=n(140),w=n.n(b),g=n(31),E=n.n(g),D=n(479),S=n.n(D),_=n(2),T=n(5),k=n(10),P=n(357),C=n(27),O=n(25),A=n(11),R=n(2165),j=n(2166),W=n(2170),I=n(2171),x=n(218),F=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),M=function(){return(M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},B=function(t,n,r,a){return new(r||(r=e))((function(e,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,s)}c((a=a.apply(t,n||[])).next())}))},N=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},H=function(e){function t(t){var n=e.call(this,t)||this;n._updateStateForEditMode=function(e){var t=h()(e,"timeSheet.data",{});n._updateWeekPeriodDataState(e,t,h()(e,"match.params.id"))},n._updateWeekPeriodDataState=function(e,t,r){var a,o,i=n.state,s=i.weekPeriodData,c=i.currentWeekPeriod;s=s||{};var l=h()(t,"timeSheetEntries",[]);if(t){var u=t.startsAt,p=t.endsAt;c=M(M({},c),{startWeekDay:d()(u).format(),endWeekDay:d()(p).format(),month:d()(u).month(),year:d()(p).year()});for(var f=n._getWeekPeriodId(c),m=f.id,y=f.startDay,b=f.endDay,w={},g=0;g<l.length;g++){var E=l[g]||{},D=h()(E,"service.id"),_=h()(E,"project.id"),T=d()(E.date).format("YYYY-MM-DD"),k=h()(E,"customer.id"),P=D+":"+(_||k),C=void 0,A=E.service;C=E.project?E.project:E.customer;var R=h()(w,P+".dayHours",{});R[T]=E.duration;var j=h()(w,P+".entries",{});j[T]=E,w[P]=M(M({},w[P]),{dayHours:R,selectedService:A,selectedProjectCustomer:C,selectedType:_?"project":"customer",selectedBtn:_?0:1,entries:j})}0===l.length&&(w=M(M({},w),((a={})[S.a.v4()]={},a)));var W={currentWeekPeriod:c,weekPeriodData:v()(s,((o={})[m]={startWeekDay:y,endWeekDay:b,alreadySavedTimesheetId:r||t.id,allowedToEdit:t.status!==O.g.FINALISED&&t.status!==O.g.APPROVED,timesheetRows:w,attachedFiles:t.attachments},o))};n.setState(W)}},n._getWeekPeriodId=function(e){var t=d()(e.startWeekDay).format("YYYY-MM-DD"),n=d()(e.endWeekDay).format("YYYY-MM-DD");return{id:t+"__"+n,startDay:t,endDay:n}},n._onWeekPeriodChange=function(e){return B(n,void 0,void 0,(function(){var t,n,r,a,o,i,s,c,l,u;return N(this,(function(p){switch(p.label){case 0:return t=this.state.weekPeriodData,n=this._getWeekPeriodId(e),r=n.id,a=n.startDay,o=n.endDay,i=this.props.profile,[4,this.props.getTimeSheets({variables:{where:{startsAt:d()(a).format(O.a),endsAt:d()(o).format(O.a),isArchived:!1,user:{id:i.id}}}})];case 1:return s=p.sent(),c=h()(s,"data.timeSheets.edges.0.node"),h()(c,"id")?this._updateWeekPeriodDataState(this.props,c):this.setState({currentWeekPeriod:e,weekPeriodData:M(M({},t),(l={},l[r]=t[r]||{startWeekDay:a,endWeekDay:o,attachedFiles:[],allowedToEdit:!0,timesheetRows:(u={},u[S.a.v4()]={},u)},l))}),[2]}}))}))},n._doesUserEnteredData=function(){var e=n.state.weekPeriodData,t=!1;for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];if(!n._isWeekPeriodEmpty(a)){var o=h()(a,"timesheetRows",{});for(var i in o)if(o.hasOwnProperty(i)){var s=h()(o,i,{});if(!n._isTimesheetEmpty(s)){t=!0;break}}}}return t},n._isWeekPeriodEmpty=function(e){for(var t=h()(e,"timesheetRows",{}),n=Object.values(t),r=!1,a=0;a<n.length;a++){var o=n[a];if(!E()(o)){r=!0;break}}return!r},n._isTimesheetEmpty=function(e){return void 0===e&&(e={}),E()(e.dayHours)||E()(e.selectedProjectCustomer)||E()(e.selectedService)},n._generatePDF=function(){return B(n,void 0,void 0,(function(){return N(this,(function(e){switch(e.label){case 0:return[4,Object(P.a)("pdf-content")];case 1:return[2,e.sent()]}}))}))},n._finaliseTimeSheet=function(e){return void 0===e&&(e=!1),B(n,void 0,void 0,(function(){var t,n,r,a,o,i,s,c,l,u,p,f,m,y,v,b,w,g,D,S,_,k,P,C,R,j,W,I,x,F,B,H;return N(this,(function(N){switch(N.label){case 0:for(c in N.trys.push([0,10,,11]),t=this.props,n=t.profile,r=t.isEditMode,a=n.selectedCompany,o=this.state.weekPeriodData,i=[],this.setState({finalisingTimesheet:!0}),s=[],o)s.push(c);l=0,N.label=1;case 1:return l<s.length?(u=s[l],o.hasOwnProperty(u)?(p=o[u],this._isWeekPeriodEmpty(p)||!p.allowedToEdit?[3,8]:(f=void 0,m=h()(p,"attachedFiles",[]).filter((function(e){return e instanceof File})).map((function(e){return e})),y={endsAt:d()(p.endWeekDay).format(O.a),startsAt:d()(p.startWeekDay).format(O.a),status:e?O.g.DRAFT:O.g.FINALISED,attachments:m.length>0?m:void 0},e?[3,3]:[4,this._generatePDF()])):[3,8]):[3,9];case 2:v=N.sent(),b=new File([v],"timesheet.pdf"),y.preview=b,N.label=3;case 3:if(w=[],g=[],!E()(p.timesheetRows))for(D=Object.values(p.timesheetRows),S=0;S<D.length;S++)if(_=D[S],!(this._isTimesheetEmpty(_)||(k=_.dayHours,P=_.selectedType,C=_.selectedProjectCustomer,R=_.selectedService,j=h()(_,"entries",{}),E()(k)||E()(C)||E()(R))))for(W in k)if(k.hasOwnProperty(W)){if(I=h()(j,W+".id"),null==k[W])continue;(H={date:d()(W).format(O.a),duration:Number(k[W]),service:{connect:{id:R.id}}})[P]={connect:{id:C.id}},x=H,I?g.push({data:x,where:{id:I}}):w.push(M({},x))}return y=M(M({},y),{timeSheetEntries:{create:w.length>0?w:void 0,update:g.length>0?g:void 0}}),p.alreadySavedTimesheetId?[4,this.props.updateTimeSheet({where:{id:p.alreadySavedTimesheetId},data:y})]:[3,5];case 4:return f=N.sent(),[3,7];case 5:return[4,this.props.createTimeSheet({data:y})];case 6:f=N.sent(),N.label=7;case 7:if(!f.success)return this.setState({finalisingTimesheet:!1,showFinaliseModal:!1}),f.error.map((function(e){return Object(A.a)(e)})),[2];F=f.result||{},i.push(F.id),this.setState({finalisingTimesheet:!1,showFinaliseModal:!1}),N.label=8;case 8:return l++,[3,1];case 9:return e?(Object(A.a)(null,r?"Timesheet draft updated":"Timesheet saved as a draft"),this.props.history.push(T.a.MY_DRAFT_TIMESHEETS())):(Object(A.a)(null,"Timesheets "+(r?"updated":"saved")+" successfully"),h()(a,"timeSheetSettings.approvalsEnabled")?this._showApprovalModal(i):this.props.history.push(T.a.TIMESHEETS())),[3,11];case 10:return B=N.sent(),this.setState({finalisingTimesheet:!1,showFinaliseModal:!1}),console.error(B),[3,11];case 11:return[2]}}))}))},n._showFinaliseAlert=function(){n.setState({showFinaliseModal:!0})},n._closeFinaliseAlert=function(){n.setState({showFinaliseModal:!1})},n._showApprovalModal=function(e){n.setState({showApprovalModal:!0,approvalTimesheets:e})},n._closeApprovalModal=function(){n.setState({showApprovalModal:!1}),n.props.history.push(T.a.TIMESHEETS())},n._getWeekNumberFromMonth=function(e,t){return d()().month(e).year(t).date(1).week()},n._updateWeekPeriod=function(e){var t,r=n.state,a=r.currentWeekPeriod,o=r.weekPeriodData,i=n._getWeekPeriodId(a).id;e.timesheetRows&&m()(o,i+".timesheetRows",{}),n.setState({weekPeriodData:v()(o,(t={},t[i]=M({},e),t))})},n._getWeekPeriod=function(){var e=n.state,t=e.weekPeriodData,r=e.currentWeekPeriod,a=n._getWeekPeriodId(r).id;return h()(t,""+a,{})},n._renderBottomButtons=function(){var e=n.props,t=e.classes,r=e.theme,a=n._doesUserEnteredData();return o.a.createElement(s.a,{container:!0,spacing:0},o.a.createElement(s.a,{item:!0,xs:12,sm:a},o.a.createElement(_.Button,{title:"Cancel",href:T.a.TIMESHEETS(),buttonColor:r.palette.grey[200],classes:{text:t.cancelButtonText}})),a&&o.a.createElement(s.a,{item:!0,xs:12,sm:6},o.a.createElement(_.Button,{id:"finalise-timesheet-bottom-button",loading:n.state.finalisingTimesheet,title:"Finalise timesheet",buttonColor:r.palette.primary.color2,onClick:n._showFinaliseAlert})))};var r=d()().year(),a=d()().month();return n.yearList=w()(r-2,r+10).map((function(e){return{label:String(e),value:e}})),n.monthList=w()(0,12).map((function(e){return{label:d()().month(e).format("MMMM"),value:e}})),n.state={currentWeekPeriod:{startWeekDay:"",endWeekDay:"",month:a,year:r,week:d()().week()},weekPeriodData:{},showFinaliseModal:!1,showApprovalModal:!1,approvalTimesheets:[],savingAsDraft:!1,finalisingTimesheet:!1},n}return F(t,e),t.prototype.componentDidMount=function(){this.props.actions.updateHeaderTitle("Timesheets")},t.prototype.componentDidUpdate=function(e){if(this.props.isEditMode){var t=h()(this.props,"projects.data"),n=h()(this.props,"services.data"),r=h()(this.props,"customers.data"),a=h()(this.props,"timeSheet.data");t===h()(e,"projects.data")&&n===h()(e,"services.data")&&r===h()(e,"customers.data")&&a===h()(e,"timeSheet.data")||this._updateStateForEditMode(this.props)}},t.prototype._renderSectionHeading=function(){var e=this,t=this.props,n=t.theme,r=t.isEditMode,a=t.classes,i=this._doesUserEnteredData();return o.a.createElement(_.SectionHeader,{classes:{component:a.sectionHeader},title:"Bulk "+(r?"update":"create")+" timesheets",subtitle:r?"Update Timesheet to track work done on a project":"Create a timesheet to track work done on a project. When you create a new timesheet you are able to create multiple timesheets for a period in time.",renderLeftPart:function(){return o.a.createElement(_.Button,{id:"save-draft",title:r?"Update Draft":"Save draft",applyBorderRadius:!0,width:260,isDisabled:!i,buttonColor:n.palette.primary.color2,onClick:function(){e._finaliseTimeSheet(!0)}})}})},t.prototype._renderTimesheetApprovalModal=function(){var e=this.state,t=e.approvalTimesheets,n=e.showApprovalModal;return o.a.createElement(R.a,{visible:n,timesheets:t,onClose:this._closeApprovalModal})},t.prototype._renderFinaliseAlert=function(){var e=this,t=this.props,n=t.theme,r=t.classes,a=t.isEditMode,i=this._doesUserEnteredData();return o.a.createElement(_.Modal,{classes:{description:r.finaliseDesc},visible:this.state.showFinaliseModal,title:"Finalise Timesheet?",description:o.a.createElement("div",null,o.a.createElement("div",null,"When you finalise a timesheet you change the status from draft to finalised therefore it can not be edited."),o.a.createElement("br",null),o.a.createElement("div",null,"Are you sure you want to finalise this timesheet?")),buttons:[{title:"Cancel",type:"cancel",onClick:function(){e._closeFinaliseAlert()}},{title:a?"Update Draft":"Save as draft",isDisabled:!i,id:"modal-save-draft",onClick:function(){e._closeFinaliseAlert(),e._finaliseTimeSheet(!0)},buttonColor:n.palette.primary.color3},{title:"Finalise",isDisabled:!i,id:"modal-finalise-timesheet",onClick:function(){e._closeFinaliseAlert(),e._finaliseTimeSheet(!1)}}]})},t.prototype.render=function(){var e=this,t=this.props,n=t.classes,r=t.projects,a=t.customers,i=t.services,s=t.actions,c=this.state.currentWeekPeriod,l=this._getWeekPeriod();return o.a.createElement(C.a,{onChange:function(){e.props.history.push(T.a.TIMESHEETS())}},o.a.createElement("div",{className:n.page},o.a.createElement("div",{className:n.content},this._renderSectionHeading(),o.a.createElement("div",{className:n.pdfContent,id:"pdf-content"},o.a.createElement(I.a,{currentWeekPeriod:c,onWeekPeriodChange:this._onWeekPeriodChange,onUpdateCurrentWeekPeriod:function(t){e.setState({currentWeekPeriod:t})}}),o.a.createElement(j.a,{projects:r,customers:a,services:i,allowedToEdit:l.allowedToEdit,timesheetRows:l.timesheetRows,currentWeekPeriod:c,onUpdateRows:this._updateWeekPeriod,actions:s,timeSheetId:l.alreadySavedTimesheetId}),o.a.createElement(W.a,{allowedToEdit:l.allowedToEdit,attachedFiles:l.attachedFiles||[],onUpdateAttachments:this._updateWeekPeriod}))),this._renderBottomButtons(),this._renderFinaliseAlert(),this._renderTimesheetApprovalModal()))},t}(a.Component);t.default=Object(c.compose)(Object(_.withStyles)(x.b),Object(l.b)((function(e){return{profile:e.profile}})),Object(c.withProps)((function(e){return{isEditMode:Boolean(h()(e,"match.params.id"))}})),Object(k.withUpdateTimeSheet)(),Object(k.withCreateTimeSheet)(),Object(k.withCustomers)((function(){return{variables:{where:{isArchived:!1},orderBy:"name_ASC"}}})),Object(k.withServices)((function(){return{variables:{where:{isArchived:!1,isTemplate:!0,billingType:O.f.TIME_BASED},orderBy:"name_ASC"}}})),Object(k.withProjects)((function(){return{variables:{where:{isArchived:!1}}}})),Object(k.withTimeSheet)((function(e){return{id:h()(e,"match.params.id")}})),Object(k.withTimeSheets)((function(){return{skip:!0}})))(H)}.call(this,n(21))},25:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l}));var r="YYYY-MM-DD[T]HH:mm:ss.SSS[Z]",a={FIXED:"FIXED",TIME_BASED:"TIME_BASED"},o={STARTED:"STARTED",CLOSED:"CLOSED"},i={PROJECT_ENDS:"PROJECT_ENDS",PROJECT_STARTS:"PROJECT_STARTS"},s={APPROVED:"APPROVED",DRAFT:"DRAFT",FINALISED:"FINALISED",INVOICED:"INVOICED"},c={APPROVED:"APPROVED",ARCHIVED:"ARCHIVED",DRAFT:"DRAFT",FULLY_PAID:"FULLY_PAID",UNPAID:"UNPAID",PARTIALLY_PAID:"PARTIALLY_PAID",PROPOSED:"PROPOSED",REJECTED:"REJECTED"},l={PROJECT:"PROJECT",TIMESHEET:"TIMESHEET",TIMESHEET_WITH_DETAILS:"TIMESHEET_WITH_DETAILS",FREE_TEXT:"FREE_TEXT"}},27:function(e,t,n){"use strict";var r=n(0),a=n(18),o=n(15),i=n(317),s=n(9),c=n.n(s);t.a=Object(a.compose)(Object(o.b)((function(e){return{selectedCompany:c()(e,(function(e){return e.profile.selectedCompany}))}})))((function(e){var t=e.selectedCompany,n=e.onChange,a=e.children;return Object(i.a)((function(){n(t)}),[t]),r.createElement(r.Fragment,null,a)}))},317:function(e,t,n){"use strict";var r=n(30),a=n.n(r),o=n(0);function i(e){var t,n,r=Object(o.useRef)();return t=e,n=r.current,a()(t,n)||(r.current=e),r.current}t.a=function(e,t){Object(o.useEffect)(e,i(t))}},357:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r=n(996),a=n.n(r),o=n(997),i=n.n(o),s=function(t,n,r,a){return new(r||(r=e))((function(e,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,s)}c((a=a.apply(t,n||[])).next())}))},c=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},l=function(e){return s(void 0,void 0,void 0,(function(){var t,n,r,o,s,l;return c(this,(function(c){switch(c.label){case 0:return t=new i.a("p","pt","letter",!0),[4,a()(document.getElementById(e),{useCORS:!0})];case 1:return n=c.sent(),r=n.toDataURL("image/png"),o=n.height/n.width,s=t.internal.pageSize.getWidth(),l=s*o,t.addImage(r,"png",0,0,s,l,"","FAST"),[2,t.output("blob")]}}))}))}}).call(this,n(21))}}]);