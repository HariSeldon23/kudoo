(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{11:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(652),i=function(e,t){void 0===e&&(e=""),void 0===t&&(t="");var n=e?"error":"success",i=e||t;Object(r.b)(i,{type:n,closeButton:!1,hideProgressBar:!0})}},2162:function(e,t,n){"use strict";t.a=function(e){return{formFields:{flex:1,padding:"0px 20px",paddingBottom:20},gstCheckbox:{paddingTop:25,marginTop:12,marginLeft:10}}}},2319:function(e,t,n){"use strict";n.r(t),function(e){var r,i=n(0),a=n.n(i),o=n(9),l=n.n(o),c=n(3),u=n.n(c),s=n(30),p=n.n(s),m=n(74),d=n(15),f=n(28),E=n(34),b=n(13),h=n(2),T=n(5),y=n(11),S=n(25),g=n(10),v=n(641),D=n(2162),C=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),O=function(t,n,r,i){return new(r||(r=e))((function(e,a){function o(e){try{c(i.next(e))}catch(e){a(e)}}function l(e){try{c(i.throw(e))}catch(e){a(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,l)}c((i=i.apply(t,n||[])).next())}))},w=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isEditMode:!1},t._submitForm=function(e,n){return O(t,void 0,void 0,(function(){var t,r,i,a,o;return w(this,(function(c){switch(c.label){case 0:return c.trys.push([0,5,,6]),t=this.props.initialData,r=this.state.isEditMode,i={name:e.name,billingType:e.billingType,includeConsTax:e.chargeGST,isTemplate:void 0===l()(t,(function(e){return e.isTemplate}))||l()(t,(function(e){return e.isTemplate})),timeBasedType:e.perUnit,totalAmount:Number(e.paymentTotal)},r?[3,2]:[4,this.props.createService({data:i})];case 1:return(a=c.sent()).success?(Object(y.a)(null,"Service created"),n.setSubmitting(!1),this.props.history.push(T.a.SERVICES())):(a.error.map((function(e){return Object(y.a)(e)})),n.setSubmitting(!1)),[3,4];case 2:return[4,this.props.updateService({data:i,where:{id:t.id}})];case 3:(a=c.sent()).success?(Object(y.a)(null,"Service updated"),n.setSubmitting(!1),this.props.history.push(T.a.SERVICES())):(a.error.map((function(e){return Object(y.a)(e)})),n.setSubmitting(!1)),c.label=4;case 4:return[3,6];case 5:throw o=c.sent(),n.setSubmitting(!1),new Error(o);case 6:return[2]}}))}))},t}return C(t,e),t.prototype.componentDidMount=function(){this.props.actions.updateHeaderTitle("Services"),this.setState({isEditMode:Boolean(l()(this.props,(function(e){return e.initialData})))})},t.prototype.componentDidUpdate=function(e){p()(this.props.initialData,e.initialData)||this.setState({isEditMode:Boolean(l()(this.props,(function(e){return e.initialData})))})},t.prototype._renderForm=function(e){var t=this.props,n=t.classes,r=t.profile,i=t.i18n,o=u()(r,"selectedCompany.salesTax"),l=e.values;return a.a.createElement(m.Grid,{container:!0,xs:12,sm:5,classes:{container:n.formFields}},a.a.createElement(m.Grid,{item:!0,xs:12},a.a.createElement(m.FormControl,{fullWidth:!0,margin:"dense"},a.a.createElement(h.FormikTextField,{label:"Service name",placeholder:"E.g: Website development",showClearIcon:!1,name:"name",id:"name"})),a.a.createElement(m.FormControl,{fullWidth:!0,margin:"dense"},a.a.createElement(h.FormikDropdown,{label:"Billing Type",id:"service-type",name:"billingType",placeholder:"Select type",items:[{label:"Fixed",value:S.f.FIXED},{label:"Time Based",value:S.f.TIME_BASED}]})),l.billingType===S.f.FIXED&&a.a.createElement(m.FormGroup,{row:!0},a.a.createElement(m.FormControl,null,a.a.createElement(h.FormikTextField,{label:"Payment Total",placeholder:"E.g: 200",isNumber:!0,showClearIcon:!1,name:"paymentTotal",id:"paymentTotal"})),o&&a.a.createElement(m.FormControl,null,a.a.createElement(h.FormikCheckbox,{label:"Charge "+i._("GST"),id:"charge-gst",name:"chargeGST",classes:{component:n.gstCheckbox}}))),l.billingType===S.f.TIME_BASED&&a.a.createElement(a.a.Fragment,null,a.a.createElement(m.FormGroup,{row:!0},a.a.createElement(m.FormControl,null,a.a.createElement(h.FormikTextField,{label:"Payment Amount",isNumber:!0,placeholder:"E.g: 200",showClearIcon:!1,name:"paymentTotal",id:"paymentTotal"})),o&&a.a.createElement(m.FormControl,null,a.a.createElement(h.FormikCheckbox,{label:"Charge "+i._("GST"),id:"charge-gst",name:"chargeGST",classes:{component:n.gstCheckbox}}))),a.a.createElement(m.FormControl,{fullWidth:!0,margin:"dense"},a.a.createElement(h.FormikDropdown,{id:"per-unit",label:"Per Unit",name:"perUnit",placeholder:"Select Unit",items:[{label:"Hour",value:"HOUR"},{label:"Half Hour",value:"HALFHOUR"},{label:"Quater Hour",value:"QUARTERHOUR"}]})))))},t.prototype.render=function(){var e=this,t=this.props,n=t.initialData,r=t.history,i=this.state.isEditMode;return a.a.createElement(h.ErrorBoundary,null,a.a.createElement(v.a,{editMode:i,header:{createTitle:"Create new service",createSubtitle:"Create a new service template. This service will be a quick template to use for defining projects, invoices and timesheets.",updateTitle:"Update Service",updateSubtitle:""},initialValues:{name:l()(n,(function(e){return e.name}))||"",billingType:l()(n,(function(e){return e.billingType}))||"",paymentTotal:String(l()(n,(function(e){return e.totalAmount}))||""),chargeGST:l()(n,(function(e){return e.includeConsTax}))||!1,perUnit:l()(n,(function(e){return e.timeBasedType}))},validationSchema:b.object().shape({name:b.string().required("Service Name is required"),billingType:b.string().required("Billing Type is required"),paymentTotal:b.string().required("Payment Total is required"),perUnit:b.mixed().when("billingType",{is:S.f.TIME_BASED,then:b.string().required("Please select unit"),otherwise:b.mixed()})}),onSubmit:this._submitForm,onCancel:function(){r.push(T.a.SERVICES())}},(function(t){return e._renderForm(t)})))},t}(i.Component);t.default=Object(E.compose)(Object(f.withI18n)(),Object(g.withCreateService)(),Object(g.withUpdateService)(),Object(g.withService)((function(e){return{id:l()(e,(function(e){return e.match.params.id}))}}),(function(e){var t=e.data;return{initialData:l()(t,(function(e){return e.service}))||{}}})),Object(d.b)((function(e){return{profile:e.profile}})),Object(h.withStyles)(D.a))(F)}.call(this,n(21))},25:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r="YYYY-MM-DD[T]HH:mm:ss.SSS[Z]",i={FIXED:"FIXED",TIME_BASED:"TIME_BASED"},a={STARTED:"STARTED",CLOSED:"CLOSED"},o={PROJECT_ENDS:"PROJECT_ENDS",PROJECT_STARTS:"PROJECT_STARTS"},l={APPROVED:"APPROVED",DRAFT:"DRAFT",FINALISED:"FINALISED",INVOICED:"INVOICED"},c={APPROVED:"APPROVED",ARCHIVED:"ARCHIVED",DRAFT:"DRAFT",FULLY_PAID:"FULLY_PAID",UNPAID:"UNPAID",PARTIALLY_PAID:"PARTIALLY_PAID",PROPOSED:"PROPOSED",REJECTED:"REJECTED"},u={PROJECT:"PROJECT",TIMESHEET:"TIMESHEET",TIMESHEET_WITH_DETAILS:"TIMESHEET_WITH_DETAILS",FREE_TEXT:"FREE_TEXT"}},27:function(e,t,n){"use strict";var r=n(0),i=n(18),a=n(15),o=n(317),l=n(9),c=n.n(l);t.a=Object(i.compose)(Object(a.b)((function(e){return{selectedCompany:c()(e,(function(e){return e.profile.selectedCompany}))}})))((function(e){var t=e.selectedCompany,n=e.onChange,i=e.children;return Object(o.a)((function(){n(t)}),[t]),r.createElement(r.Fragment,null,i)}))},317:function(e,t,n){"use strict";var r=n(30),i=n.n(r),a=n(0);function o(e){var t,n,r=Object(a.useRef)();return t=e,n=r.current,i()(t,n)||(r.current=e),r.current}t.a=function(e,t){Object(a.useEffect)(e,o(t))}},641:function(e,t,n){"use strict";var r=n(0),i=n(2),a=n(27),o=n(4),l=n.n(o),c=n(39),u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};t.a=Object(i.withStyles)((function(e){return{page:{flex:1,display:"flex",flexDirection:"column",position:"relative"},sectionHeader:{padding:"20px 20px"},form:{flex:1,display:"flex",flexDirection:"column"},cancelButtonText:{color:e.palette.primary.color3}}}))((function(e){var t=e.classes,n=e.onCompanyChange,o=e.editMode,p=e.header,m=e.children,d=e.initialValues,f=e.validationSchema,E=e.onSubmit,b=e.theme,h=e.onCancel;return r.createElement(i.ErrorBoundary,null,r.createElement(a.a,{onChange:n},r.createElement("div",{className:t.page},function(){if(!p)return null;var e=p.createSubtitle,n=p.updateSubtitle,a=p.updateTitle,l=p.createTitle,c=s(p,["createSubtitle","updateSubtitle","updateTitle","createTitle"]);return r.createElement(i.SectionHeader,u({title:o?a:l,subtitle:o?n:e,classes:{component:t.sectionHeader}},c))}(),r.createElement(c.Formik,{initialValues:d,enableReinitialize:!0,validationSchema:f,onSubmit:E},(function(e){var n=e.dirty,a=u(u({},e),{isContentDirty:n});return r.createElement("form",{className:t.form,onSubmit:e.handleSubmit},"function"==typeof m?m(a):m,r.createElement(l.a,{container:!0,spacing:0},r.createElement(l.a,{item:!0,xs:12,sm:n?6:12},r.createElement(i.Button,{title:"Cancel",buttonColor:b.palette.grey[200],classes:{text:t.cancelButtonText},type:"button",onClick:h})),n&&r.createElement(l.a,{item:!0,xs:12,sm:6},r.createElement(i.Button,{loading:e.isSubmitting,id:"submit-button",type:"submit",title:o?"Update":"Save",buttonColor:b.palette.primary.color2}))))})))))}))}}]);