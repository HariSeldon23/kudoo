(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{11:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(652),i=function(e,t){void 0===e&&(e=""),void 0===t&&(t="");var r=e?"error":"success",i=e||t;Object(n.b)(i,{type:r,closeButton:!1,hideProgressBar:!0})}},2318:function(e,t,r){"use strict";r.r(t);var n,i=r(0),o=r.n(i),c=r(4),s=r.n(c),a=r(28),l=r(2),u=r(640),p=r(475),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._showDeleteDialog=function(e){var r=t.props.theme,n=o.a.createElement("div",null,o.a.createElement("div",null,"You are trying to permanently delete a service. This action is not reversable."),o.a.createElement("br",null),o.a.createElement("div",null,"Are you sure you want to delete this service?")),i=[{title:"Cancel",type:"cancel",onClick:function(){t.props.actions.closeAlertDialog()}},{title:"Delete Service",buttonColor:r.palette.secondary.color2,onClick:function(){t.props.actions.closeAlertDialog(),t.props.onRemoveServiceClicked(e)}}],c=r.palette.secondary.color2;t.props.actions.showAlertDialog({title:"Permanently delete service?",description:n,buttons:i,titleColor:c})},t._showUnarchivedDialog=function(e){var r=t.props.theme,n=o.a.createElement("div",null,o.a.createElement("div",null,"Are you sure you want to activate this service?")),i=[{title:"Cancel",type:"cancel",onClick:function(){t.props.actions.closeAlertDialog()}},{title:"Activate Service",onClick:function(){t.props.actions.closeAlertDialog(),t.props.onUnarchiveServiceClicked(e)}}],c=r.palette.primary.color1;t.props.actions.showAlertDialog({title:"Activate service?",description:n,buttons:i,titleColor:c})},t._renderCell=function(e,r,n){var i=t.props.classes;return"totalAmount"===r.id?o.a.createElement("div",{className:i.amountCell},o.a.createElement(a.Trans,{id:"currency-symbol"})," ",e[r.id]):n},t}return d(t,e),t.prototype._renderSectionHeading=function(){var e=this,t=this.props.theme;return o.a.createElement(l.SectionHeader,{title:"Service Templates",subtitle:"Below is a list of all your archived services.",renderLeftPart:function(){return o.a.createElement(l.Button,{title:"Create New Service",applyBorderRadius:!0,width:260,buttonColor:t.palette.primary.color2,onClick:e.props.goToCreateService})}})},t.prototype._renderServices=function(){var e=this,t=this.props,r=t.classes,n=t.theme;return o.a.createElement("div",{className:r.servicesContainer},o.a.createElement(s.a,{container:!0},o.a.createElement(s.a,{item:!0,xs:12,sm:6},o.a.createElement(l.ToggleButton,{labels:["All","Fixed Billing","Timed Billing"],selectedIndex:0,activeColor:n.palette.primary.color1,onChange:this.props.onTypeChange}))),o.a.createElement(l.Table,{columnData:this.props.columns,data:this.props.services,sortable:!0,showAddIcon:!0,onRequestSort:this.props.onSortRequested,onRemoveClicked:this._showDeleteDialog,onAddClicked:this._showUnarchivedDialog,cellRenderer:this._renderCell,loading:this.props.fetchingServices,onBottomReachedThreshold:500,onBottomReached:function(t){e.props.fetchingServices||e.props.onLoadMore()}}))},t.prototype.render=function(){var e=this.props.classes;return o.a.createElement(l.ErrorBoundary,null,o.a.createElement("div",{className:e.tabContent},this._renderSectionHeading(),this._renderServices()))},t}(i.Component),v=Object(l.withStyles)(Object(l.composeStyles)(p.b,p.a))(f);t.default=Object(u.a)({type:"archived-services"})(v)},25:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"f",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"g",(function(){return s})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return l}));var n="YYYY-MM-DD[T]HH:mm:ss.SSS[Z]",i={FIXED:"FIXED",TIME_BASED:"TIME_BASED"},o={STARTED:"STARTED",CLOSED:"CLOSED"},c={PROJECT_ENDS:"PROJECT_ENDS",PROJECT_STARTS:"PROJECT_STARTS"},s={APPROVED:"APPROVED",DRAFT:"DRAFT",FINALISED:"FINALISED",INVOICED:"INVOICED"},a={APPROVED:"APPROVED",ARCHIVED:"ARCHIVED",DRAFT:"DRAFT",FULLY_PAID:"FULLY_PAID",UNPAID:"UNPAID",PARTIALLY_PAID:"PARTIALLY_PAID",PROPOSED:"PROPOSED",REJECTED:"REJECTED"},l={PROJECT:"PROJECT",TIMESHEET:"TIMESHEET",TIMESHEET_WITH_DETAILS:"TIMESHEET_WITH_DETAILS",FREE_TEXT:"FREE_TEXT"}},27:function(e,t,r){"use strict";var n=r(0),i=r(18),o=r(15),c=r(317),s=r(9),a=r.n(s);t.a=Object(i.compose)(Object(o.b)((function(e){return{selectedCompany:a()(e,(function(e){return e.profile.selectedCompany}))}})))((function(e){var t=e.selectedCompany,r=e.onChange,i=e.children;return Object(c.a)((function(){r(t)}),[t]),n.createElement(n.Fragment,null,i)}))},317:function(e,t,r){"use strict";var n=r(30),i=r.n(n),o=r(0);function c(e){var t,r,n=Object(o.useRef)();return t=e,r=n.current,i()(t,r)||(n.current=e),n.current}t.a=function(e,t){Object(o.useEffect)(e,c(t))}},475:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),t.b=function(e){return{page:{flex:1,display:"flex",flexDirection:"column"}}};var n=function(e){return{tabContent:{padding:"40px 20px",flex:1,display:"flex",flexDirection:"column"},noActiveServicesWrapper:{flex:1,alignItems:"center",justifyContent:"center",display:"flex",margin:"50px 0px"},noServiceMessageWrapper:{width:"60%",maxWidth:660,margin:"0px auto",border:"4px dashed "+e.palette.grey[300],padding:10,borderRadius:20,minHeight:200,backgroundColor:e.palette.grey[100],alignItems:"center",justifyContent:"center",display:"flex"},noServiceMessage:{fontFamily:e.typography.font.family1,fontSize:26,lineHeight:"35px",fontWeight:"500",color:e.palette.blueGrey[50],textAlign:"center"},servicesContainer:{marginTop:"20px !important"},nameValueCell:{cursor:"pointer",color:e.palette.primary.color2,fontWeight:500},amountCell:{paddingLeft:24,paddingRight:24}}}},640:function(e,t,r){"use strict";(function(e){var n,i=r(0),o=r(37),c=r.n(o),s=r(3),a=r.n(s),l=r(15),u=r(18),p=r(5),d=r(11),f=r(25),v=r(10),h=r(27),y=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),S=function(){return(S=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},m=function(t,r,n,i){return new(n||(n=e))((function(e,o){function c(e){try{a(i.next(e))}catch(e){o(e)}}function s(e){try{a(i.throw(e))}catch(e){o(e)}}function a(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(c,s)}a((i=i.apply(t,r||[])).next())}))},E=function(e,t){var r,n,i,o,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,n=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){c.label=o[1];break}if(6===o[0]&&c.label<i[1]){c.label=i[1],i=o;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(o);break}i[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={columns:[{id:"name",label:"Service",sorted:!0,order:"asc"},{id:"billingType",label:"Type"},{id:"timeBasedType",label:"Unit Type"},{id:"totalAmount",label:"Amount"}],displayedServices:[]},t._updateServices=function(e){t._transformServiceData(e)},t._transformServiceData=function(e){if(e){var r=a()(e,"data",[]).map((function(e){var t=e.billingType===f.f.FIXED?"Fixed Billing":"Time Based Billing";return S(S({},e),{name:e.name,billingType:t,timeBasedType:e.timeBasedType||"â€”",totalAmount:""+e.totalAmount})}));t.setState({displayedServices:r})}},t._goToCreateService=function(){t.props.history.push(p.a.CREATE_SERVICES())},t._goToEditService=function(e){t.props.history.push(p.a.EDIT_SERVICE({id:e}))},t._onTypeChange=function(e,r){var n=t.props.setShowingServiceType;0===r?n("ALL"):1===r?n(f.f.FIXED):2===r&&n(f.f.TIME_BASED)},t._onSortRequested=function(e){return m(t,void 0,void 0,(function(){var t,r,n,i,o;return E(this,(function(s){switch(s.label){case 0:return t=this.state.columns,r=c.a.find(t,{sorted:!0}),n=c.a.find(t,{id:e.id}),i="asc",r.id===n.id&&"asc"===r.order&&(i="desc"),o={orderBy:n.id+"_"+i.toUpperCase()},[4,this.props.services.refetch(o)];case 1:return s.sent(),r.sorted=!1,n.sorted=!0,n.order=i,this.setState({columns:t}),[2]}}))}))},t._onArchiveServiceClicked=function(e){return m(t,void 0,void 0,(function(){var t,r;return E(this,(function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),[4,this.props.archiveService({where:{id:e.id},data:{isArchived:!0}})];case 1:return(t=n.sent()).success?(Object(d.a)(null,"Service archived successfully"),[4,this.props.services.refetch()]):[3,3];case 2:return n.sent(),[3,4];case 3:t.error((function(e){return Object(d.a)(e)})),n.label=4;case 4:return[3,6];case 5:throw r=n.sent(),Object(d.a)("Something went wrong"),new Error(r);case 6:return[2]}}))}))},t._onUnarchiveServiceClicked=function(e){return m(t,void 0,void 0,(function(){var t,r;return E(this,(function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),[4,this.props.unArchiveService({where:{id:e.id},data:{isArchived:!1}})];case 1:return(t=n.sent()).success?(Object(d.a)(null,"Service activated successfully"),[4,this.props.services.refetch()]):[3,3];case 2:return n.sent(),[3,4];case 3:t.error((function(e){return Object(d.a)(e)})),n.label=4;case 4:return[3,6];case 5:throw r=n.sent(),Object(d.a)("Something went wrong"),new Error(r);case 6:return[2]}}))}))},t._onRemoveServiceClicked=function(e){return m(t,void 0,void 0,(function(){var t,r;return E(this,(function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),[4,this.props.deleteService({where:{id:e.id}})];case 1:return(t=n.sent()).success?(Object(d.a)(null,"Service deleted successfully"),[4,this.props.services.refetch()]):[3,3];case 2:return n.sent(),[3,4];case 3:t.error((function(e){return Object(d.a)(e)})),n.label=4;case 4:return[3,6];case 5:throw r=n.sent(),new Error(r);case 6:return[2]}}))}))},t}return y(t,e),t.prototype.componentDidMount=function(){this._updateServices(this.props.services)},t.prototype.componentDidUpdate=function(e){c.a.isEqual(this.props.services,e.services)||this._updateServices(this.props.services)},t.prototype.render=function(){var e=this.props.styledComponent,t=this.props.services,r=void 0===t?{}:t;return i.createElement(h.a,{onChange:r.refetch},i.createElement(e,{actions:this.props.actions,services:this.state.displayedServices,totalServices:a()(this.props,"services.data.length"),columns:this.state.columns,fetchingServices:a()(this.props,"services.loading"),onTypeChange:this._onTypeChange,goToCreateService:this._goToCreateService,goToEditService:this._goToEditService,onArchiveServiceClicked:this._onArchiveServiceClicked,onUnarchiveServiceClicked:this._onUnarchiveServiceClicked,onRemoveServiceClicked:this._onRemoveServiceClicked,onSortRequested:this._onSortRequested,onLoadMore:this.props.services.loadNextPage}))},t.defaultProps={services:{refetch:function(){},loadNextPage:function(){}}},t}(i.Component),g=Object(u.compose)(Object(l.b)((function(e){return{profile:e.profile}})),Object(u.withState)("showingServicesType","setShowingServiceType","ALL"),Object(v.withServices)((function(e){var t,r,n=e.type;return"active-services"===n?t=!1:"archived-services"===n&&(t=!0),e.showingServicesType===f.f.FIXED?r=f.f.FIXED:e.showingServicesType===f.f.TIME_BASED&&(r=f.f.TIME_BASED),{variables:{first:20,where:{isArchived:t,isTemplate:!0,billingType:r},orderBy:"name_ASC"}}})),Object(v.withDeleteService)(),Object(v.withUpdateService)((function(){return{name:"archiveService"}})),Object(v.withUpdateService)((function(){return{name:"unArchiveService"}})))(b);t.a=function(e){return function(t){return function(r){return i.createElement(g,S({styledComponent:t},e,r))}}}}).call(this,r(21))}}]);