(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{11:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(652),a=function(e,t){void 0===e&&(e=""),void 0===t&&(t="");var n=e?"error":"success",a=e||t;Object(o.b)(a,{type:n,closeButton:!1,hideProgressBar:!0})}},2045:function(e,t,n){"use strict";var o,a=n(0),r=n(7),i=n.n(r),s=n(9),c=n.n(s),p=n(35),l=n.n(p),u=n(30),d=n.n(u),m=n(4),f=n.n(m),y=n(140),C=n.n(y),h=n(2),v=n(642),b=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(){return(g=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputRefs=[],t.state={joinCompanyTab:0,restCompanies:[],shouldJoinCompaniesList:[],code:{},currentFocusedInput:0},t._updateShouldJoinCompaniesList=function(e){var n=e.joinedCompanies,o=e.createdCompanies,a=e.allCompanies,r=(c()(a,(function(e){return e.data}))||[]).filter((function(e){var t=!1;return t||(t=l()(o||[],{id:e.id})),t||(t=l()(n||[],{id:e.id})),!t}));r=r.map((function(e){return g(g({},e),{label:e.name})})),t.setState({shouldJoinCompaniesList:r,restCompanies:r})},t._onCompanySearch=function(e){var n=t.state.restCompanies.filter((function(t){return t.label.toLowerCase().indexOf(e.toLowerCase())>-1}));t.setState({shouldJoinCompaniesList:n})},t._renderTitle=function(){var e=t.props.classes;return a.createElement("div",{className:e.title},"How do you want to join?")},t._onChangeCode=function(e,n){var o,a=t.state.code;e?(t.setState({code:g(g({},a),(o={},o[n]=e,o))}),n<=4&&t._focus(n+1)):(delete a[n],t.setState({code:a}))},t._onKeyUp=function(e,n){var o=t.state.currentFocusedInput;37===e.keyCode?t._focus(o-1):39===e.keyCode&&t._focus(o+1)},t._focus=function(e){e>=0&&e<=5&&(t.setState({currentFocusedInput:e}),t.inputRefs[e].focus())},t._renderContent=function(){var e=t.props,n=e.theme,o=e.classes,r=t.state,i=r.joinCompanyTab,s=r.shouldJoinCompaniesList,c=r.code;return a.createElement("div",{className:o.contentWrapper},a.createElement(h.ToggleButton,{labels:["I have an access code","Request access"],selectedIndex:i,onChange:function(e,n){t.setState({joinCompanyTab:n})},activeColor:n.palette.primary.color1}),a.createElement("div",{className:o.fieldTitle},0===i?"Please type your 6 digit number":"Company name"),a.createElement("div",{className:o.joinCompanyFieldContent},0===i?a.createElement(f.a,{container:!0,spacing:8},C()(0,6).map((function(e){return a.createElement(f.a,{item:!0,xs:2,key:e},a.createElement(h.TextField,{placeholder:"-",getRef:function(n){t.inputRefs[e]=n},value:c[e]||"",showClearIcon:!1,maxlength:1,onKeyUp:function(n){return t._onKeyUp(n,e)},onChangeText:function(n){t._onChangeCode(n,e)},classes:{textInput:o.accessCodeField}}))}))):a.createElement(h.SearchInput,{placeholder:"Search by typing company name",showClearIcon:!1,onSearch:t._onCompanySearch,onInputChange:t._onCompanySearch,onItemClick:function(){},items:s})))},t._renderButtons=function(){var e=t.props,n=e.theme,o=e.classes,r=e.onClose,i=t.state.joinCompanyTab;return a.createElement(f.a,{container:!0,classes:{container:o.buttons}},a.createElement(f.a,{item:!0,xs:6},a.createElement(h.Button,{classes:{text:o.cancelButtonText},title:"Cancel",onClick:r,buttonColor:n.palette.grey[100]})),a.createElement(f.a,{item:!0,xs:6},a.createElement(h.Button,{buttonColor:n.palette.primary.color2,title:0===i?"Join Company":"Request Access"})))},t}return b(t,e),t.prototype.componentDidMount=function(){this._updateShouldJoinCompaniesList(this.props)},t.prototype.componentDidUpdate=function(e){d()(c()(this.props,(function(e){return e.createdCompanies})),c()(e,(function(e){return e.createdCompanies})))&&d()(c()(this.props,(function(e){return e.joinedCompanies})),c()(e,(function(e){return e.joinedCompanies})))&&d()(c()(this.props,(function(e){return e.allCompanies.data})),c()(e,(function(e){return e.allCompanies.data})))||this._updateShouldJoinCompaniesList(this.props)},t.prototype.render=function(){var e=this.props,t=e.classes,n=e.visible;return a.createElement(h.ErrorBoundary,null,a.createElement("div",{className:i()(t.modalWrapper,{visible:n,hide:!n})},a.createElement("div",{className:t.modal},this._renderTitle(),this._renderContent(),this._renderButtons())))},t}(a.Component);t.a=Object(h.withStyles)(v.a)(w)},2276:function(e,t,n){"use strict";n.r(t),function(e){var o,a=n(0),r=n.n(a),i=n(15),s=n(7),c=n.n(s),p=n(3),l=n.n(p),u=n(35),d=n.n(u),m=n(9),f=n.n(m),y=n(30),C=n.n(y),h=n(101),v=n(34),b=n(2),g=n(5),w=n(131),E=n.n(w),_=n(10),j=n(23),O=n(11),x=n(2045),S=n(642),N=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),T=function(){return(T=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},I=function(t,n,o,a){return new(o||(o=e))((function(e,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(i,s)}c((a=a.apply(t,n||[])).next())}))},k=function(e,t){var n,o,a,r,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(a=2&r[0]?o.return:r[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,r[1])).done)return a;switch(o=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,o=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){i.label=r[1];break}if(6===r[0]&&i.label<a[1]){i.label=a[1],a=r;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(r);break}a[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],o=0}finally{n=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},J=function(e){function t(t){var n=e.call(this,t)||this;return n._reactivateCompany=function(e){return function(t){return I(n,void 0,void 0,(function(){var t,n;return k(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.props.actions.selectCompany(T(T({},e),{owner:!0})),[4,this.props.updateCompany({data:{isArchived:!1},where:{id:e.id}})];case 1:return(t=o.sent()).success?(Object(O.a)(null,"Company Re-activated"),window.location.reload()):t.error.map((function(e){return Object(O.a)(e)})),[3,3];case 2:return n=o.sent(),Object(O.a)(n.toString()),[3,3];case 3:return[2]}}))}))}},n._openJoinCompanyModal=function(){n.setState({joinCompanyModalVisible:!0})},n._closeJoinCompanyModal=function(){n.setState({joinCompanyModalVisible:!1})},n.state={isCreatedCompanyOpen:!0,isJoinedCompanyOpen:!0,joinCompanyModalVisible:!1},n}return N(t,e),t.prototype.componentDidMount=function(){this.props.actions.updateHeaderTitle("Manage Companies"),this.props.actions.setTemporaryActiveLanguage(void 0)},t.prototype.componentDidUpdate=function(e){var t=this.props.profile;C()(l()(this.props,"companies.createdCompanies",[]).map((function(e){return e.id})),l()(e,"companies.createdCompanies",[]).map((function(e){return e.id})))&&C()(l()(t,"createdCompanies",[]).map((function(e){return e.id})),l()(e,"companies.createdCompanies",[]).map((function(e){return e.id})))||this.props.actions.setUserData({createdCompanies:l()(this.props,"companies.createdCompanies",[])})},t.prototype._renderCreatedCompanies=function(){var e=this,t=this.props,n=t.classes,o=t.companies,a=t.theme,i=this.state.isCreatedCompanyOpen;return r.a.createElement("div",{className:n.collapseRoot},r.a.createElement("div",{className:n.collapseTitle,onClick:function(){e.setState({isCreatedCompanyOpen:!i})}},r.a.createElement("div",null,"Created Companies"),r.a.createElement("i",{className:c()("icon icon-chevron-right",n.collapseIcon,{down:i})})),r.a.createElement(E.a,{in:this.state.isCreatedCompanyOpen,timeout:"auto",unmountOnExit:!0,"data-test":"create-company-wrapper",classes:{wrapperInner:n.collapseContent}},r.a.createElement(h.a,{className:n.cardComponent,to:g.a.CREATE_COMPANY()},r.a.createElement(b.DottedCreateButton,{id:"create-company",text:"Create new company"})),(f()(o,(function(e){return e.createdCompanies}))||[]).map((function(t){return r.a.createElement("div",{className:n.companyCardWrapper,key:t.id,"data-test":t.isArchived?"created-archived-company-"+t.name:"created-company-"+t.name},r.a.createElement(h.a,{className:n.companyCard,to:g.a.COMPANY_SETTINGS({companyId:t.id}),onClick:function(){e.props.actions.selectCompany(T(T({},t),{owner:!0}))}},r.a.createElement(b.CompanyCard,{imageUrl:l()(t,"logo.url")?l()(t,"logo.url"):void 0,primaryLabel:t.name,secondaryLabel:"Owner"})),t.isArchived&&r.a.createElement("div",{className:n.deletedCompanyMsgWrapper},r.a.createElement("div",{className:n.deletedCompanyMsg},"This company has been deleted and will disappear after 7 days."),r.a.createElement(b.Button,{title:"Re-activate",applyBorderRadius:!0,buttonColor:a.palette.primary.color2,onClick:e._reactivateCompany(t)})))}))))},t.prototype._renderJoinedCompanies=function(){var e=this,t=this.props,n=t.classes,o=t.companies,a=t.theme,i=this.state.isJoinedCompanyOpen;return r.a.createElement("div",{className:n.collapseRoot},r.a.createElement("div",{className:n.collapseTitle,onClick:function(){e.setState({isJoinedCompanyOpen:!i})}},r.a.createElement("div",null,"Joined Companies"),r.a.createElement("i",{className:c()("icon icon-chevron-right",n.collapseIcon,{down:i})})),r.a.createElement(E.a,{in:this.state.isJoinedCompanyOpen,timeout:"auto",unmountOnExit:!0,classes:{wrapperInner:n.collapseContent}},(f()(o,(function(e){return e.joinedCompanies}))||[]).map((function(e){return r.a.createElement("div",{className:n.companyCardWrapper,key:e.id,"data-test":e.isArchived?"joined-archived-company-"+e.name:"joined-company-"+e.name},r.a.createElement("div",{className:n.companyCard,style:{cursor:"initial"}},r.a.createElement(b.CompanyCard,{imageUrl:l()(e,"logo.url")?l()(e,"logo.url"):void 0,primaryLabel:e.name,secondaryLabel:"Employee",borderColor:a.palette.primary.color3,isJoinedCompany:!0})),e.isArchived&&r.a.createElement("div",{className:n.deletedCompanyMsgWrapper},r.a.createElement("div",{className:n.deletedCompanyMsg},"This company has been deleted and will disappear after 7 days.")))}))))},t.prototype.render=function(){var e=this.props,t=e.classes,n=e.companies,o=e.allCompanies,a=this.state.joinCompanyModalVisible;return r.a.createElement("div",{className:t.page},this._renderCreatedCompanies(),this._renderJoinedCompanies(),r.a.createElement(x.a,{visible:a,createdCompanies:l()(n,"createdCompanies",[]),joinedCompanies:l()(n,"joinedCompanies",[]),allCompanies:o,onClose:this._closeJoinCompanyModal}))},t}(a.Component);t.default=Object(v.compose)(Object(b.withStyles)(S.b),Object(i.b)((function(e){return{profile:e.profile}})),Object(_.withUpdateCompany)(),Object(_.withCompanies)((function(e){return{variables:{joined:!0,created:!0}}}),(function(e){for(var t=e.data,n=e.ownProps,o=l()(t,"companies")||[],a=[],r=[],i=0;i<o.length;i++){var s=o[i]||{},c=d()(s.companyMembers,{user:{id:l()(n,"profile.id")}}),p=j.c.user;l()(n,"profile.isRoot")?p=j.c.root:"OWNER"===c.role?p=j.c.owner:"ADMIN"===c.role&&(p=j.c.admin),"OWNER"===c.role||"ADMIN"===c.role?a.push(T(T({},s),{role:p})):r.push(T(T({},s),{role:p}))}return{createdCompanies:a,joinedCompanies:r}})),Object(_.withCompanies)((function(e){return{name:"allCompanies",variables:{joined:!0,created:!0}}})))(J)}.call(this,n(21))},642:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),t.b=function(e){return{page:{padding:"40px 10px"},collapseRoot:{marginBottom:10},collapseTitle:{backgroundColor:e.palette.primary.color3,padding:20,fontFamily:e.typography.font.family2,fontSize:25,fontWeight:500,color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between"},collapseIcon:{transform:"rotate(0deg)",transition:"all ease-in 0.2s","&.down":{transform:"rotate(90deg)"}},collapseContent:{padding:20,display:"flex",alignItems:"center",flexWrap:"wrap"},cardComponent:{marginRight:10,marginBottom:10},companyCard:{cursor:"pointer"},companyCardWrapper:{position:"relative",marginRight:10,marginBottom:10},deletedCompanyMsgWrapper:{position:"absolute",top:0,right:0,bottom:0,left:0,padding:10,borderRadius:5,backgroundColor:"rgba(0,0,0,0.7)",fontFamily:e.typography.font.family2,display:"flex",flexDirection:"column",justifyContent:"space-between"},deletedCompanyMsg:{color:"white",textAlign:"center",fontWeight:"500",lineHeight:"25px"}}};var o=function(e){return{modalWrapper:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.4)",zIndex:1e4,overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,height:0,transition:"opacity 0.1s ease-in","&.visible":{opacity:1,height:"100vh"},"&.hide":{opacity:0,height:0}},modal:{backgroundColor:"white",borderRadius:5,maxWidth:600,minWidth:600},title:{padding:40,fontSize:24,fontFamily:e.typography.font.family1,fontWeight:"bold",textAlign:"center",color:e.palette.primary.color1},contentWrapper:{padding:20,paddingTop:0},fieldTitle:{fontFamily:e.typography.font.family2,color:e.palette.blueGrey[50],fontSize:17,marginTop:20,textAlign:"center"},joinCompanyFieldContent:{marginTop:20},accessCodeField:{textAlign:"center",fontSize:30,padding:"10px !important"},buttons:{marginTop:20},cancelButtonText:{color:e.palette.blueGrey[50]}}}}}]);