(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{11:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(652),o=function(e,t){void 0===e&&(e=""),void 0===t&&(t="");var r=e?"error":"success",o=e||t;Object(n.b)(o,{type:r,closeButton:!1,hideProgressBar:!0})}},2289:function(e,t,r){"use strict";r.r(t);var n,o=r(0),s=r.n(o),c=r(4),a=r.n(c),i=r(101),u=r(31),l=r.n(u),p=r(2),m=r(5),h=r(639),f=r(474),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),y=function(){return(y=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._showArchiveDialog=function(e){var r=t.props.theme,n="Archive "+e.name+"?",o=s.a.createElement("div",null,s.a.createElement("div",null,"Are you sure you want to archive this customer?")),c=[{title:"Cancel",type:"cancel",onClick:function(){t.props.actions.closeAlertDialog()}},{title:"Archive",onClick:function(){t.props.actions.closeAlertDialog(),t.props.onArchiveCustomer(e)}}],a=r.palette.primary.color2;t.props.actions.showAlertDialog({title:n,description:o,buttons:c,titleColor:a})},t._renderCell=function(e,r,n){var o=t.props.classes;return"name"===r.id?s.a.createElement(i.a,{to:m.a.CUSTOMER_DETAILS({id:e.id}),className:o.customerNameCell},n):n},t}return d(t,e),t.prototype._renderSectionHeading=function(){var e=this.props,t=e.history,r=e.theme;return s.a.createElement(p.SectionHeader,{title:"Customer Index",subtitle:"Below is a list of all your saved customers.",renderLeftPart:function(){return s.a.createElement(p.Button,{title:"Create Customer",applyBorderRadius:!0,width:260,buttonColor:r.palette.primary.color2,onClick:function(){t.push(m.a.CREATE_CUSTOMER())}})}})},t.prototype._renderNoActiveCustomers=function(){var e=this.props.classes;return s.a.createElement("div",{className:e.noCustomersWrapper},s.a.createElement("div",{className:e.noCustomerMessageWrapper},s.a.createElement("div",{className:e.noCustomerMessage},"You have not created any customers yet.",s.a.createElement("br",null),"Letâ€™s start by creating your first customer.")))},t.prototype._renderCustomers=function(){var e=this.props,t=e.classes,r=e.customers,n=e.columns,o=e.onSortRequested,c=e.onSearchCustomer;return s.a.createElement("div",{className:t.customersContainer},s.a.createElement(a.a,{item:!0,xs:12,sm:6},s.a.createElement(p.SearchInput,{classes:{component:t.searchInput},placeholder:"Search by typing a company name",items:[],onSearch:c})),s.a.createElement(p.Table,{columnData:n,data:r,sortable:!0,stripe:!1,onRequestSort:o,showRemoveIcon:!0,onRemoveClicked:this._showArchiveDialog,cellRenderer:this._renderCell}))},t.prototype.render=function(){var e=this.props,t=e.classes,r=e.customers;return s.a.createElement(p.ErrorBoundary,null,s.a.createElement("div",{className:t.tabContent},this._renderSectionHeading(),l()(r)&&this._renderNoActiveCustomers(),!l()(r)&&this._renderCustomers()))},t}(o.Component),C=Object(p.withStyles)(Object(p.composeStyles)(f.b,f.a))(v);t.default=function(e){return s.a.createElement(h.a,y({},e,{type:"active-customers"}),(function(e){return s.a.createElement(C,y({},e))}))}},27:function(e,t,r){"use strict";var n=r(0),o=r(18),s=r(15),c=r(317),a=r(9),i=r.n(a);t.a=Object(o.compose)(Object(s.b)((function(e){return{selectedCompany:i()(e,(function(e){return e.profile.selectedCompany}))}})))((function(e){var t=e.selectedCompany,r=e.onChange,o=e.children;return Object(c.a)((function(){r(t)}),[t]),n.createElement(n.Fragment,null,o)}))},317:function(e,t,r){"use strict";var n=r(30),o=r.n(n),s=r(0);function c(e){var t,r,n=Object(s.useRef)();return t=e,r=n.current,o()(t,r)||(n.current=e),n.current}t.a=function(e,t){Object(s.useEffect)(e,c(t))}},474:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),t.b=function(e){return{page:{flex:1,display:"flex",flexDirection:"column"}}};var n=function(e){return{tabContent:{padding:"40px 20px",flex:1,display:"flex",flexDirection:"column"},noCustomersWrapper:{flex:1,alignItems:"center",justifyContent:"center",display:"flex",margin:"50px 0px"},noCustomerMessageWrapper:{width:"60%",maxWidth:660,margin:"0px auto",border:"4px dashed "+e.palette.grey[300],padding:10,borderRadius:20,minHeight:200,backgroundColor:e.palette.grey[100],alignItems:"center",justifyContent:"center",display:"flex"},noCustomerMessage:{fontFamily:e.typography.font.family1,fontSize:26,lineHeight:"35px",fontWeight:"500",color:e.palette.blueGrey[50],textAlign:"center"},customersContainer:{marginTop:"20px !important"},searchInput:{margin:"30px 0px"},customerNameCell:{fontFamily:e.typography.font.family2,color:e.palette.primary.color2,cursor:"pointer",fontWeight:500},greenCell:{color:e.palette.primary.color1,fontWeight:"bold"},orangeCell:{color:e.palette.secondary.color1,fontWeight:"bold"},pagination:{marginTop:20}}}},639:function(e,t,r){"use strict";(function(e){var n,o=r(0),s=r.n(o),c=r(9),a=r.n(c),i=r(30),u=r.n(i),l=r(35),p=r.n(l),m=r(34),h=r(15),f=r(10),d=r(27),y=r(11),v=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),C=function(t,r,n,o){return new(n||(n=e))((function(e,s){function c(e){try{i(o.next(e))}catch(e){s(e)}}function a(e){try{i(o.throw(e))}catch(e){s(e)}}function i(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(c,a)}i((o=o.apply(t,r||[])).next())}))},b=function(e,t){var r,n,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,n=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){c=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){c.label=s[1];break}if(6===s[0]&&c.label<o[1]){c.label=o[1],o=s;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(s);break}o[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},w=function(e){function t(t){var r=e.call(this,t)||this;return r._onSortRequested=function(e){return C(r,void 0,void 0,(function(){var t,r,n,o,s;return b(this,(function(c){switch(c.label){case 0:return t=this.state.columns,r=p()(t,{sorted:!0}),n=p()(t,{id:e.id}),o="asc",r.id===n.id&&"asc"===r.order&&(o="desc"),s={orderBy:n.id+"_"+o.toUpperCase()},[4,this.props.customers.refetch(s)];case 1:return c.sent(),r.sorted=!1,n.sorted=!0,n.order=o,this.setState({columns:t}),[2]}}))}))},r._onArchiveCustomer=function(e){return C(r,void 0,void 0,(function(){var t,r;return b(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.props.archiveCustomer({where:{id:e.id},data:{isArchived:!0}})];case 1:return(t=n.sent()).success?(Object(y.a)(null,"Customer archived successfully"),this.props.customers.refetch()):t.error((function(e){return Object(y.a)(e)})),[3,3];case 2:throw r=n.sent(),Object(y.a)("Something went wrong"),new Error(r);case 3:return[2]}}))}))},r._onUnarchiveCustomer=function(e){return C(r,void 0,void 0,(function(){var t,r;return b(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.props.unArchiveCustomer({where:{id:e.id},data:{isArchived:!1}})];case 1:return(t=n.sent()).success?(Object(y.a)(null,"Customer activated successfully"),this.props.customers.refetch()):t.error((function(e){return Object(y.a)(e)})),[3,3];case 2:throw r=n.sent(),Object(y.a)("Something went wrong"),new Error(r);case 3:return[2]}}))}))},r._onRemoveCustomer=function(e){return C(r,void 0,void 0,(function(){var t,r;return b(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.props.deleteCustomer({where:{id:e.id}})];case 1:return(t=n.sent()).success?(Object(y.a)(null,"Customer deleted successfully"),this.props.customers.refetch()):t.error((function(e){return Object(y.a)(e)})),[3,3];case 2:throw r=n.sent(),Object(y.a)("Something went wrong"),new Error(r);case 3:return[2]}}))}))},r._searchCustomer=function(e){return C(r,void 0,void 0,(function(){return b(this,(function(t){return this.props.customers.refetch({where:{name_contains:e||void 0}}),[2]}))}))},r.state={displayedCustomers:a()(t,(function(e){return e.customers.data})),columns:[{id:"name",label:"Customer name",sorted:!0,order:"asc"},{id:"email",label:"Email"},{id:"projects",label:"Projects"},{id:"money_made",label:"Money Made"},{id:"money_owed",label:"Money Owed"}]},r}return v(t,e),t.prototype.componentDidUpdate=function(e){var t=a()(e,(function(e){return e.customers.data}))||[],r=a()(this.props,(function(e){return e.customers.data}))||[];u()(t,r)||this._updateCustomers(r)},t.prototype._updateCustomers=function(e){this.setState({displayedCustomers:e})},t.prototype.render=function(){var e=this.state,t=e.displayedCustomers,r=e.columns,n=this.props,o=n.match,c=n.history,a=n.location,i=n.actions,u=n.customers,l=void 0===u?{}:u;return s.a.createElement(d.a,{onChange:l.refetch},this.props.children({match:o,history:c,location:a,actions:i,customers:t,columns:r,onSortRequested:this._onSortRequested,onArchiveCustomer:this._onArchiveCustomer,onUnarchiveCustomer:this._onUnarchiveCustomer,onRemoveCustomer:this._onRemoveCustomer,onSearchCustomer:this._searchCustomer}))},t}(o.Component);t.a=Object(m.compose)(Object(h.b)((function(e){return{profile:e.profile}})),Object(f.withCustomers)((function(e){e.profile;var t=!1;return"archived-customers"===e.type&&(t=!0),{variables:{where:{isArchived:t},orderBy:"name_ASC"}}})),Object(f.withDeleteCustomer)(),Object(f.withUpdateCustomer)((function(){return{name:"archiveCustomer"}})),Object(f.withUpdateCustomer)((function(){return{name:"unArchiveCustomer"}})))(w)}).call(this,r(21))}}]);