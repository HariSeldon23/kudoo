(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{2163:function(e,t,n){"use strict";(function(e){var r,o=n(0),i=n.n(o),a=n(18),s=n(2),l=n(10),c=n(11),u=n(173),p=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(){return(d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},m=function(t,n,r,o){return new(r||(r=e))((function(e,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,s)}l((o=o.apply(t,n||[])).next())}))},h=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={emails:{to:[],bcc:[],cc:[]},submitting:!1},t._sendTimesheetNotificationEmail=function(){return m(t,void 0,void 0,(function(){var e,t,n;return h(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=this.props.timesheetId,t=this.state.emails,this.setState({submitting:!0}),[4,this.props.timeSheetNotify({timeSheetId:e,to:(t.to||[]).map((function(e){return e.email})),bcc:(t.bcc||[]).map((function(e){return e.email})),cc:(t.cc||[]).map((function(e){return e.email}))})];case 1:return r.sent(),this.setState({submitting:!1}),Object(c.a)(null,"Email sent"),this.props.onClose(),[3,3];case 2:return n=r.sent(),this.setState({submitting:!1}),Object(c.a)(n.toString()),[3,3];case 3:return[2]}}))}))},t}return p(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.classes,r=t.onClose,o=t.visible,a=this.state,l=a.emails,c=a.submitting,u=l.to.length<=0||c;return i.a.createElement(s.Modal,{visible:o,onClose:r,showCloseButton:!0,title:"Send Timesheet Notify Email",description:i.a.createElement("div",null,i.a.createElement("div",null,"Please add emails"),i.a.createElement(s.EmailInputFields,{classes:{component:n.emailInputs},onEmailChange:function(t){var n=e.state.emails;e.setState({emails:d(d({},n),t)})}})),buttons:[{title:c?"Submitting...":"Submit",onClick:this._sendTimesheetNotificationEmail,isDisabled:u,loading:c}]})},t.defaultProps={onClose:function(){}},t}(o.Component);t.a=Object(a.compose)(Object(s.withStyles)(u.b),Object(l.withTimeSheetNotify)())(f)}).call(this,n(21))},2352:function(e,t,n){"use strict";n.r(t);var r,o=n(0),i=n.n(o),a=n(7),s=n.n(a),l=n(3),c=n.n(l),u=n(31),p=n.n(u),d=n(252),m=n.n(d),h=n(2),f=n(5),v=n(471),y=n(472),b=n(2163),w=n(18),E=n(24),_=n.n(E),N=n(173),T=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r},C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderCell=function(e,n,r){var o=t.props.classes;if("date"===n.id){var a=e[n.id];return i.a.createElement("div",{className:o.commonCell},_()(a).format("DD MMM YYYY"))}if("invoiced"===n.id){var s=e.isInvoiced;return i.a.createElement("div",{className:o.commonCell},s?"YES":"NO")}if("hours"===n.id){var l=e.duration||0;return i.a.createElement("div",{className:o.commonCell},l," ",m()("hour",l))}return r},t}return T(t,e),t.prototype.render=function(){var e=this.props,t=e.onClose,n=e.visible,r=e.entries,o=e.classes,a=g(r);return a.sort((function(e,t){return _()(e.date).isBefore(t.date)?-1:_()(e.date).isAfter(t.date)?1:0})),i.a.createElement(h.Modal,{classes:{description:o.modalDescription},visible:n,onClose:t,showCloseButton:!1,title:"Timesheet Entries",description:i.a.createElement(h.Table,{columnData:[{id:"date",label:"Date"},{id:"invoiced",label:"Invoiced"},{id:"hours",label:"Duration"}],data:a,showRemoveIcon:!1,showAddIcon:!1,stripe:!1,sortable:!1,cellRenderer:this._renderCell}),buttons:[{title:"Close",onClick:t}]})},t.defaultProps={onClose:function(){}},t}(o.Component),S=Object(w.compose)(Object(h.withStyles)(N.c))(C),O=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),M=function(){return(M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={allHide:!1,showNotificationModal:!1,notifiedTimesheetId:null},t._showTimesheetNotificationModal=function(e){t.setState({notifiedTimesheetId:e,showNotificationModal:!0})},t._closeTimesheetNotificationModal=function(){t.setState({notifiedTimesheetId:null,showNotificationModal:!1})},t}return O(t,e),t.prototype._renderSectionHeading=function(){var e=this.props,t=e.history,n=e.theme;return i.a.createElement(h.SectionHeader,{title:"Timesheets",subtitle:"Below is a list of all your active timesheets.",renderLeftPart:function(){return i.a.createElement(h.Button,{title:"Create new timesheet",applyBorderRadius:!0,width:260,buttonColor:n.palette.primary.color2,onClick:function(){t.push(f.a.CREATE_TIMESHEETS())}})}})},t.prototype._renderFilterUserDropdown=function(){var e=this.props,t=e.onlyMyTimesheet,n=e.users,r=e.addFilteredUser,o=e.removeFilteredUser,a=e.classes;return t?null:i.a.createElement("div",{className:a.dropdownWrapper},i.a.createElement(h.Dropdown,{label:"Filter Users",items:n.map((function(e){return{label:e.firstName+" "+e.lastName,value:e}})),multiple:!0,onChange:function(e,t,n){n?r(e.value):o(e.value)}}))},t.prototype._renderNoTimesheets=function(){var e=this.props.classes;return i.a.createElement("div",{className:e.noTimesheetsWrapper},i.a.createElement("div",{className:e.noTimesheetsMessageWrapper},i.a.createElement("div",{className:e.noTimesheetsMessage},"There are no active Timesheets. ",i.a.createElement("br",null),"Letâ€™s start by creating a new Timesheet.")))},t.prototype._renderTimesheets=function(){var e=this,t=this.props,n=t.classes,r=t.history,o=t.timeSheetData,a=t.toggleViewEntriesModal,l=t.loadMore,u=this.state.allHide;return i.a.createElement(h.ScrollObserver,{onBottomReached:function(){return l()},onBottomReachedThreshold:500},i.a.createElement("div",{className:n.timesheetsContainer},i.a.createElement("div",{className:n.expandHideWrapper},i.a.createElement("span",{className:s()(n.expandHideLabel,{active:u}),onClick:function(){e.setState({allHide:!1})}},"Expand"),i.a.createElement("span",{className:n.slash},"/"),i.a.createElement("span",{className:s()(n.expandHideLabel,{active:!u}),onClick:function(){e.setState({allHide:!0})}},"Hide")),Object.keys(o).map((function(t){var s=o[t],l=c()(s,"project")||{},d=c()(s,"service")||{},h=c()(s,"customer")||{},y="hour";return"DAY"===d.timeBasedType&&(y="day"),i.a.createElement("div",{className:n.timesheet,key:s.id},i.a.createElement(v.a,{type:p()(s.project)?"company":"project",collapsed:u,serviceName:d.name,companyName:h.name,project:l.name,rows:Object.keys(s.rows).map((function(e){var t=s.rows[e],n=c()(t,"user",{}),r=n.firstName,o=n.lastName;return{id:t.id,user:r+" "+o,period:t.startsAt+" - "+t.endsAt,status:t.status,hours:t.hours+" "+m()(y,t.hours),totalHours:t.hours,startsAt:t.startsAtFormatted,entries:t.entries}})),onCellClick:function(t,n){var o=n.row,i=n.column;"email"===i.id?e._showTimesheetNotificationModal(o.id):"view"===i.id?a(!0,o.entries):r.push(f.a.REVIEW_TIMESHEET({id:o.id}))}}))}))))},t.prototype._renderTimesheetNotificationModal=function(){var e=this.state,t=e.showNotificationModal,n=e.notifiedTimesheetId;return i.a.createElement(b.a,{visible:t,timesheetId:n,onClose:this._closeTimesheetNotificationModal})},t.prototype._renderViewEntriesModal=function(){var e=this.props,t=e.showViewEntriesModal,n=e.toggleViewEntriesModal,r=e.showingEntriesInModal;return t?i.a.createElement(S,{visible:t,onClose:function(){n(!1)},entries:r}):null},t.prototype.render=function(){var e=this.props,t=e.classes,n=e.timeSheetData,r=e.timeSheetsLoading;return i.a.createElement(h.ErrorBoundary,null,i.a.createElement("div",{className:t.page},this._renderSectionHeading(),this._renderFilterUserDropdown(),r&&i.a.createElement(h.Loading,null),!r&&p()(n)&&this._renderNoTimesheets(),!p()(n)&&this._renderTimesheets()),this._renderTimesheetNotificationModal(),this._renderViewEntriesModal())},t}(o.Component),I=Object(h.withStyles)(N.a)(j);t.default=function(e){return i.a.createElement(y.a,M({},e,{timesheet_type:"active"}),(function(e){return i.a.createElement(I,M({},e))}))}}}]);