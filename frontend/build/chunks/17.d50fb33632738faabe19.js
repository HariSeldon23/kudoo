(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{11:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a(652),n=function(e,t){void 0===e&&(e=""),void 0===t&&(t="");var a=e?"error":"success",n=e||t;Object(r.b)(n,{type:a,closeButton:!1,hideProgressBar:!0})}},158:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return n})),t.c=function(e){return{page:{flex:1,display:"flex",flexDirection:"column",position:"relative"},allSteps:{padding:"40px 20px 100px"},prevNextWrapper:{display:"flex",alignItems:"center"},prevNextButton:{width:180,margin:"0px 10px"},content:{marginTop:"50px !important"},formHeading:{marginTop:40},form:{marginTop:20},halfFieldWRow:{display:"flex",alignItems:"flex-start"},input:{marginTop:10,position:"relative"},leftInput:{marginRight:10},searchInputWrapper:{display:"flex",alignItems:"center"},searchInput:{borderTopRightRadius:0,borderBottomRightRadius:0},searchIcon:{backgroundColor:e.palette.primary.color1,padding:"16px 25px",color:"white",fontSize:20,borderTopRightRadius:5,borderBottomRightRadius:5,display:"flex",alignItems:"center",justifyContent:"center"},draftButtonWrapper:{display:"flex",alignItems:"center",position:"absolute",left:0,right:0,bottom:0},cancelButtonText:{color:e.palette.primary.color3},checkbox:{margin:"10px 0px"},chargeGSTCheckbox:{paddingTop:25,marginTop:12},noServices:{border:"1px solid "+e.palette.grey[300],borderRadius:5,marginTop:20,height:400,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:40},noServicesText:{fontFamily:e.typography.font.family2,fontSize:20,color:e.palette.grey[400],fontWeight:"bold",textAlign:"center",cursor:"pointer"},services:{marginTop:20},serviceAlert:{border:"2px solid "+e.palette.primary.color1,padding:10,borderRadius:5,margin:"20px 0px",color:e.palette.primary.color1,display:"flex",alignItems:"center",justifyContent:"space-between"},serviceAlertText:{fontFamily:e.typography.font.family1,fontSize:16,fontWeight:"bold",color:e.palette.primary.color1,lineHeight:"22px"},alertRemoveIcon:{padding:"10px 20px",fontSize:30,color:e.palette.primary.color1,cursor:"pointer"},rulesServices:{marginTop:15},rulesService:{border:"1px solid "+e.palette.grey[300],cursor:"pointer",padding:20,"&.active":{backgroundColor:e.palette.primary.color3}},rulesServiceName:{marginBottom:10,fontFamily:e.typography.font.family2,fontSize:16,color:e.palette.blueGrey[50],".active &":{color:"white"}},rulesServiceAssign:{fontFamily:e.typography.font.family2,fontSize:16,color:e.palette.grey[300]},newRuleContainer:{marginTop:0},rulesList:{marginTop:20,border:"1px solid "+e.palette.grey[300]},noRules:{fontFamily:e.typography.font.family1,fontWeight:"bold",fontSize:17,padding:"30px 20px",color:e.palette.grey[300],textAlign:"center",cursor:"pointer"},rule:{borderBottom:"1px solid "+e.palette.grey[300],display:"flex",alignItems:"center","&:last-child":{borderBottom:"0px solid"}},ruleDescription:{padding:20,display:"flex",alignItems:"center",justifyContent:"space-between",color:e.palette.blueGrey[50],fontSize:16,flex:1},ruleLabel:{flex:1},rulePercentage:{padding:"0px 10px",fontWeight:"bold"},ruleAmount:{padding:"0px 10px",width:60,textAlign:"right",fontWeight:"bold"},highlightRuleText:{color:e.palette.primary.color1,fontSize:17},ruleRemoveIcon:{padding:"20px 25px",borderLeft:"1px solid "+e.palette.grey[300],fontSize:25,color:e.palette.grey[300],cursor:"pointer"},serviceTotal:{backgroundColor:e.palette.primary.color3,padding:20,display:"flex",alignItems:"center",justifyContent:"space-between"},serviceTotalLabel:{fontFamily:e.typography.font.family1,fontWeight:"bold",fontSize:24,color:"white"}}};var r=function(e){return{projectNameWrapper:{backgroundColor:e.palette.primary.color1,padding:20,borderTopLeftRadius:5,borderTopRightRadius:5,fontSize:24,fontFamily:e.typography.font.family1,color:"white",fontWeight:"bold",marginTop:15,display:"flex",alignItems:"center"},projectInfoWrapper:{},reviewSection:{},reviewSectionHeader:{backgroundColor:e.palette.grey[100],padding:20,fontSize:24,fontFamily:e.typography.font.family1,color:e.palette.blueGrey[50],border:"1px solid "+e.palette.grey[300],borderBottom:"0px",fontWeight:"bold",display:"flex",alignItems:"center"},reviewSectionContent:{padding:20,border:"1px solid "+e.palette.grey[300],borderBottom:"0px"},customerValue:{margin:[[10,0]],color:e.palette.blueGrey[50],fontSize:16,height:18},customerKey:{margin:[[10,0]],color:"#c4c4c4",fontSize:16},value:{margin:[[10,0]],color:e.palette.blueGrey[50],fontSize:16,height:18},greenValue:{color:e.palette.primary.color1},editIcon:{fontSize:"17px !important",color:e.palette.primary.color2,marginLeft:15,cursor:"pointer"},sectionWithBottomBorder:{borderBottom:"1px solid "+e.palette.grey[300]}}},n=function(e){return{serviceBlock:{display:"flex",alignItems:"center",backgroundColor:e.palette.grey[100],border:"1px solid "+e.palette.grey[300],"&:first-child":{borderTopRightRadius:5,borderTopLeftRadius:5},"&:last-child":{borderBottomRightRadius:5,borderBottomLeftRadius:5}},serviceInfo:{padding:20,flex:1,borderRight:"1px solid "+e.palette.grey[300]},serviceName:{fontFamily:e.typography.font.family2,fontSize:18,color:e.palette.grey[600]},serviceTypeWrapper:{display:"flex",alignItems:"center",marginTop:10,justifyContent:"space-between"},serviceType:{fontFamily:e.typography.font.family2,fontSize:15,color:e.palette.grey[500]},servicePrice:{fontFamily:e.typography.font.family2,fontSize:15,color:e.palette.grey[500]},serviceRemoveIcon:{padding:"10px 30px",fontSize:30,color:e.palette.grey[400],cursor:"pointer"}}}},2103:function(e,t,a){"use strict";(function(e){var r,n=a(0),o=a.n(n),i=a(4),c=a.n(i),l=a(7),s=a.n(l),m=a(28),p=a(35),u=a.n(p),d=a(3),f=a.n(d),v=a(9),y=a.n(v),h=a(15),g=a(24),b=a.n(g),E=a(34),S=a(2),T=a(5),N=a(204),x=a(10),C=a(25),w=a(11),_=a(158),j=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),P=function(){return(P=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},O=function(t,a,r,n){return new(r||(r=e))((function(e,o){function i(e){try{l(n.next(e))}catch(e){o(e)}}function c(e){try{l(n.throw(e))}catch(e){o(e)}}function l(t){var a;t.done?e(t.value):(a=t.value,a instanceof r?a:new r((function(e){e(a)}))).then(i,c)}l((n=n.apply(t,a||[])).next())}))},R=function(e,t){var a,r,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(a)throw new TypeError("Generator is already executing.");for(;i;)try{if(a=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{a=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t._isThereFixedService=function(){var e=t.props.createNewProject.service;return Boolean(u()(e,{billingType:C.f.FIXED}))},t._createProject=function(){return O(t,void 0,void 0,(function(){var e,t,a,r,n,o,i,c,l,s,m,p,u,d,v,y;return R(this,(function(h){switch(h.label){case 0:for(h.trys.push([0,2,,3]),e=this.props.createNewProject||{},a=(t=e||{}).customer,r=t.service,n=void 0,n=a.isAlreadySaved?{connect:{id:a.id}}:{create:{name:a.companyName,govNumber:a.govNumber,contacts:{create:[{name:a.contactName,surname:a.contactSurname,email:a.email}]}}},o=[],i=0;i<(r||[]).length;i++)c=r[i],l=[],c.billingType===C.f.FIXED&&(s=Boolean(f()(c,"paymentRule")),m=f()(c,"paymentRule.projectBegins"),p=f()(c,"paymentRule.projectEnds"),l=s?[{amount:Number(f()(m,"amount")),percent:Number(f()(m,"percentage")),type:C.d.PROJECT_STARTS,isPercent:"percentage"===m.fixedOrPercent},{amount:Number(f()(p,"amount")),percent:Number(f()(p,"percentage")),type:C.d.PROJECT_ENDS,isPercent:"percentage"===p.fixedOrPercent}]:[{amount:0,percent:0,type:C.d.PROJECT_STARTS,isPercent:!0},{amount:Number(f()(c,"paymentTotal")),percent:100,type:C.d.PROJECT_ENDS,isPercent:!0}]),u={},u=c.isAlreadySaved?{amount:Number(c.paymentTotal),service:{connect:{id:c.id}},rules:l.length>0?{create:l}:void 0}:{amount:Number(c.paymentTotal),rules:l.length>0?{create:l}:void 0,service:{create:{name:c.name,billingType:c.billingType,includeConsTax:c.chargeGST,isTemplate:c.isTemplate,timeBasedType:c.perUnit?c.perUnit:void 0,totalAmount:Number(c.paymentTotal)}}},o.push(u);return d={name:e.name,startsAt:b()().toISOString(),status:C.e.STARTED,customer:n,projectService:o.length>0?{create:o}:void 0},[4,this.props.createProject({data:d})];case 1:return(v=h.sent()).success?(Object(w.a)(null,"Project created successfully"),this.props.resetNewProjectData(),this.props.history.push(T.a.PROJECTS())):v.error((function(e){return Object(w.a)(e)})),[3,3];case 2:return y=h.sent(),Object(w.a)(y.toString()),[3,3];case 3:return[2]}}))}))},t._goToStep=function(e){return function(a){t.props.makeStepActive(e)}},t}return j(t,e),t.prototype._renderProjectName=function(){var e=this.props,t=e.classes,a=e.createNewProject;return o.a.createElement("div",{className:t.projectNameWrapper},a.name,o.a.createElement("i",{className:s()("fa fa-pencil",t.editIcon),style:{color:"white"},onClick:this._goToStep(0)}))},t.prototype._renderCustomerSection=function(){var e=this.props,t=e.classes,a=e.createNewProject.customer,r=e.i18n;return o.a.createElement("div",{className:t.reviewSection},o.a.createElement("div",{className:t.reviewSectionHeader},"Customer Details",o.a.createElement("i",{className:s()("fa fa-pencil",t.editIcon),onClick:this._goToStep(1)})),o.a.createElement("div",{className:t.reviewSectionContent},o.a.createElement(c.a,{container:!0,spacing:16},o.a.createElement(c.a,{item:!0,xs:6},o.a.createElement("div",{className:t.customerValue},a.companyName),o.a.createElement("div",{className:t.customerValue},a.contactName," ",a.contactSurname),o.a.createElement("div",{className:t.customerValue},a.govNumber),o.a.createElement("div",{className:t.customerValue,style:{marginBottom:0}},a.email)),o.a.createElement(c.a,{item:!0,xs:6},o.a.createElement("div",{className:t.customerKey},"Company name"),o.a.createElement("div",{className:t.customerKey},"Contact name"),o.a.createElement("div",{className:t.customerKey},r._("ABN")),o.a.createElement("div",{className:t.customerKey,style:{marginBottom:0}},"Email")))))},t.prototype._renderRulesSection=function(){var e=this.props,t=e.classes,a=e.createNewProject.service,r=e.i18n;return o.a.createElement("div",{className:t.reviewSection},o.a.createElement("div",{className:t.reviewSectionHeader},o.a.createElement(c.a,{container:!0,spacing:16},o.a.createElement(c.a,{item:!0,xs:6},"Services",o.a.createElement("i",{className:s()("fa fa-pencil",t.editIcon),onClick:this._goToStep(2)})),o.a.createElement(c.a,{item:!0,xs:6},"Rules Applied",o.a.createElement("i",{className:s()("fa fa-pencil",t.editIcon),onClick:this._goToStep(3)})))),a.map((function(e,n){var i,l=n===a.length-1,p=Boolean(y()(e,(function(e){return e.paymentRule}))),u=y()(e,(function(e){return e.paymentRule.projectBegins})),d=y()(e,(function(e){return e.paymentRule.projectEnds}));return o.a.createElement("div",{"data-test":"added-service-"+e.name,className:s()(t.reviewSectionContent,(i={},i[t.sectionWithBottomBorder]=l,i)),key:n},o.a.createElement(c.a,{container:!0,spacing:16},o.a.createElement(c.a,{item:!0,xs:6},o.a.createElement("div",{className:t.value},e.name),o.a.createElement("div",{className:t.value,style:{textTransform:"capitalize"}},e.billingType," Payment"),o.a.createElement("div",{className:t.value},o.a.createElement(m.Trans,{id:"currency-symbol"}),e.paymentTotal," ",e.billingType===C.f.TIME_BASED?"per "+(e.perUnit.toLowerCase()||""):""," ",e.chargeGST?"incl":"excl"," ",r._("GST"))),e.billingType===C.f.FIXED?o.a.createElement(c.a,{item:!0,xs:6},p&&o.a.createElement("div",{className:t.value},"Project Starts:"," ","percentage"===y()(u,(function(e){return e.fixedOrPercent}))?y()(u,(function(e){return e.percentage}))+"%":r._("currency-symbol")+""+y()(u,(function(e){return e.amount}))),p&&o.a.createElement("div",{className:t.value},"Project Ends:"," ","percentage"===y()(d,(function(e){return e.fixedOrPercent}))?y()(d,(function(e){return e.percentage}))+"%":r._("currency-symbol")+""+y()(d,(function(e){return e.amount}))),!p&&o.a.createElement("div",null,o.a.createElement("div",{className:t.value},"Project Ends: 100%"),o.a.createElement("div",{className:s()(t.value,t.greenValue)},"Becasue you didn’t assign any rules to this service we have applied our default."))):o.a.createElement(c.a,{item:!0,xs:6},o.a.createElement("div",{className:s()(t.value,t.greenValue)},"Rules can’t be applied to Time-based payments"))))})))},t.prototype.render=function(){var e=this,t=this.props,a=t.classes,r=t.makeStepActive,n=t.unmarkedVisited,i=t.theme;return o.a.createElement("div",null,o.a.createElement(S.SectionHeader,{title:"Review your project",subtitle:"Check the details below ",renderLeftPart:function(){return o.a.createElement("div",{className:a.prevNextWrapper},o.a.createElement(S.Button,{title:"Previous",classes:{component:a.prevNextButton},applyBorderRadius:!0,compactMode:!0,buttonColor:i.palette.primary.color2,withoutBackground:!0,onClick:function(){e._isThereFixedService()?(r(3),n(4)):(r(2),n(4),n(3),n(2))}}),o.a.createElement(S.Button,{title:"Create Project",id:"create-project-button",classes:{component:a.prevNextButton},applyBorderRadius:!0,compactMode:!0,buttonColor:i.palette.primary.color2,onClick:e._createProject}))}}),this._renderProjectName(),o.a.createElement("div",{className:a.projectInfoWrapper},this._renderCustomerSection(),this._renderRulesSection()))},t}(n.Component);t.a=Object(E.compose)(Object(m.withI18n)(),Object(S.withStyles)(Object(S.composeStyles)(_.c,_.a)),Object(h.b)((function(e){return{createNewProject:y()(e,(function(e){return e.sessionData.newProject})),profile:e.profile}}),P({},N.a)),Object(x.withCreateCustomer)(),Object(x.withCustomer)((function(e){return{id:f()(e,"createNewProject.customer.id","")}})),Object(x.withCreateProject)())(I)}).call(this,a(21))},2338:function(e,t,a){"use strict";a.r(t);var r,n=a(0),o=a.n(n),i=a(71),c=a.n(i),l=a(15),s=a(18),m=a(2),p=a(5),u=a(27),d=a(204),f=a(4),v=a.n(f),y=a(9),h=a.n(y),g=a(158),b=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),E=function(){return(E=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.classes,r=t.theme,n=t.updateProjectName,i=t.createNewProject;return o.a.createElement("div",null,o.a.createElement(m.SectionHeader,{title:"Create a new project",subtitle:"A project allows you to manage your customers and billing payments.",renderLeftPart:function(){return o.a.createElement("div",{className:a.prevNextWrapper},o.a.createElement(m.Button,{title:"Next",id:"next-button",classes:{component:a.prevNextButton},applyBorderRadius:!0,compactMode:!0,buttonColor:r.palette.primary.color2,onClick:function(){e.props.makeStepActive(1),e.props.markedVisited(0)}}))}}),o.a.createElement(v.a,{container:!0,classes:{container:a.content}},o.a.createElement(v.a,{item:!0,xs:12,sm:6},o.a.createElement(m.TextField,{label:"Project name",id:"project-name",name:"project-name",placeholder:"Eg. Work for Netflix",value:i.name,onChangeText:n,showClearIcon:!1}))))},t}(n.Component),T=Object(l.b)((function(e){return{createNewProject:h()(e,(function(e){return e.sessionData.newProject}))}}),E({},d.a))(S),N=Object(m.withStyles)(g.c)(T),x=a(7),C=a.n(x),w=a(28),_=a(3),j=a.n(_),P=a(39),O=a(13),R=a(10),I=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),A=function(){return(A=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t._onSearch=function(e){(0,t.props.setSearchText)(e)},t._goToNextScreen=function(){var e=t.props,a=e.makeStepActive,r=e.markedVisited;a(2),r(1)},t._getInitialValue=function(){var e=t.props.createNewProject.customer;return e.isAlreadySaved?{companyName:"",name:"",surname:"",govNumber:"",email:""}:{companyName:e.companyName||"",name:e.contactName||"",surname:e.contactSurname||"",govNumber:e.govNumber||"",email:e.email||""}},t}return I(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.classes,r=t.unmarkedVisited,n=t.theme,i=t.makeStepActive,c=t.updateCustomerInfo,l=t.createNewProject.customer,s=t.i18n,p=j()(this.props,"customers.data")||[];return o.a.createElement("div",null,o.a.createElement(m.SectionHeader,{title:"Customers",subtitle:"Add or create a customer using the form below.",renderLeftPart:function(){return o.a.createElement("div",{className:a.prevNextWrapper},o.a.createElement(m.Button,{title:"Prev",classes:{component:a.prevNextButton},applyBorderRadius:!0,compactMode:!0,buttonColor:n.palette.primary.color2,withoutBackground:!0,onClick:function(){i(0),r(0)}}),o.a.createElement(m.Button,{title:"Next",id:"next-button",classes:{component:a.prevNextButton},applyBorderRadius:!0,compactMode:!0,buttonColor:n.palette.primary.color2,onClick:function(){l.isAlreadySaved?e._goToNextScreen():e.customerForm.submitForm()}}))}}),o.a.createElement(v.a,{container:!0},o.a.createElement(v.a,{item:!0,xs:12,sm:6},o.a.createElement(m.SectionHeader,{title:"Add an exisitng customer",classes:{component:a.formHeading}}),o.a.createElement("form",{className:a.form},o.a.createElement(m.SearchInput,{placeholder:"Search by typing a customer’s name or company ",showClearIcon:!1,items:p.map((function(e){return A(A({},e),{label:e.name})})),onSearch:this._onSearch,onInputChange:this._onSearch,defaultInputValue:l.isAlreadySaved?l.companyName:"",onItemClick:function(e){c({companyName:j()(e,"name")||"",contactName:j()(e,"contacts[0].name")||"",contactSurname:j()(e,"contacts[0].surname")||"",govNumber:j()(e,"govNumber")||"",email:j()(e,"contacts[0].email")||"",id:j()(e,"id")||"",isAlreadySaved:!!e})}})),o.a.createElement(m.SectionHeader,{title:"Create a new customer",classes:{component:a.formHeading}}),o.a.createElement(P.Formik,{initialValues:this._getInitialValue(),validationSchema:O.object().shape({companyName:O.string().required("Company Name is required"),name:O.string().required("Contact Name is required"),surname:O.string().required("Surname is required"),govNumber:O.string().required(s._("ABN")+" is required"),email:O.string().required("Email is required").email("Email is not valid")}),onSubmit:function(t){c({companyName:t.companyName,contactName:t.name,contactSurname:t.surname,govNumber:String(t.govNumber.replace(/ /g,"")),email:t.email}),e._goToNextScreen()},render:function(e){var t=e.values,r=e.errors,n=e.touched,i=e.handleChange,c=e.handleBlur,l=e.handleSubmit;e.isSubmitting;return o.a.createElement("form",{className:a.form,autoComplete:"off",onSubmit:l},o.a.createElement("div",{className:a.input},o.a.createElement(m.TextField,{name:"companyName",id:"companyName",value:t.companyName,label:"Company name",placeholder:"E.g: Google",showClearIcon:!1,onChange:i,onBlur:c,error:n.companyName&&r.companyName})),o.a.createElement("div",{className:C()(a.halfFieldWRow,a.input)},o.a.createElement(m.TextField,{label:"Contact name",placeholder:"E.g: John",showClearIcon:!1,classes:{component:a.leftInput},name:"name",id:"name",value:t.name,onChange:i,onBlur:c,error:n.name&&r.name}),o.a.createElement(m.TextField,{label:"Contact surname",placeholder:"E.g: Smith",showClearIcon:!1,name:"surname",id:"surname",value:t.surname,onChange:i,onBlur:c,error:n.surname&&r.surname})),o.a.createElement("div",{className:C()(a.halfFieldWRow,a.input)},o.a.createElement(m.TextField,{label:s._("ABN"),placeholder:"E.g: 51824753556",showClearIcon:!1,classes:{component:a.leftInput},name:"govNumber",id:"govNumber",value:(t.govNumber||"").replace(/ /g,""),onChange:i,onBlur:c,error:n.govNumber&&r.govNumber}),o.a.createElement(m.TextField,{label:"Email",placeholder:"E.g: johndoe@gmail.com",showClearIcon:!1,name:"email",id:"email",value:t.email,onChange:i,onBlur:c,error:n.email&&r.email})))}}))))},t}(n.Component),B=Object(s.compose)(Object(w.withI18n)(),Object(m.withStyles)(g.c),Object(l.b)((function(e){return{createNewProject:e.sessionData.newProject,profile:e.profile}}),A({},d.a)),Object(s.withState)("searchText","setSearchText",""),Object(R.withCustomers)((function(e){var t;return e.searchText&&(t=e.searchText),{variables:{where:{isArchived:!1,name_contains:t},orderBy:"name_ASC"}}})))(k),D=a(35),F=a.n(D),V=a(34),H=a(25),W=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t}return W(t,e),t.prototype.render=function(){var e=this.props,t=e.classes,a=e.name,r=e.type,n=e.price,i=e.chargeGST,c=e.perUnit,l=e.onRemoveClick,s=e.i18n,m=s._("GST");return o.a.createElement("div",{className:t.serviceBlock,"data-test":"added-service-"+a},o.a.createElement("div",{className:t.serviceInfo},o.a.createElement("div",{className:t.serviceName},a),o.a.createElement("div",{className:t.serviceTypeWrapper},o.a.createElement("div",{className:t.serviceType},r===H.f.FIXED?"Fixed Payment":"Time Based Payment"),o.a.createElement("div",{className:t.servicePrice},s._("currency-symbol"),n," ",r===H.f.TIME_BASED&&"per "+c," ",i?"incl "+m:"excl "+m))),o.a.createElement("div",{className:t.serviceRemoveIcon,onClick:l},o.a.createElement("i",{className:"ion-android-close"})))},t}(n.Component),G=Object(s.compose)(Object(m.withStyles)(g.b),Object(w.withI18n)())(L),M=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),z=function(){return(z=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={alertVisible:!0,selectedSavedServiceIndex:-1},t._isThereTimeBasedService=function(){var e=t.props.createNewProject.service;return Boolean(F()(e,{billingType:H.f.TIME_BASED}))},t._isThereFixedService=function(){var e=t.props.createNewProject.service;return Boolean(F()(e,{billingType:H.f.FIXED}))},t}return M(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.classes,r=t.makeStepActive,n=t.markedVisited,i=t.unmarkedVisited,c=t.theme,l=t.addService,s=t.removeService,p=t.createNewProject.service,u=t.services,d=t.i18n;return o.a.createElement("div",null,o.a.createElement(m.SectionHeader,{title:"Services",subtitle:"Add or create a service using the form below.",renderLeftPart:function(){return o.a.createElement("div",{className:a.prevNextWrapper},o.a.createElement(m.Button,{title:"Prev",classes:{component:a.prevNextButton},applyBorderRadius:!0,compactMode:!0,buttonColor:c.palette.primary.color2,withoutBackground:!0,onClick:function(){r(1),i(1)}}),o.a.createElement(m.Button,{title:"Next",id:"next-button",classes:{component:a.prevNextButton},applyBorderRadius:!0,compactMode:!0,isDisabled:0===p.length,buttonColor:c.palette.primary.color2,onClick:function(){e._isThereFixedService()?(r(3),n(2)):(r(4),n(2),n(3))}}))}}),o.a.createElement(v.a,{container:!0,spacing:40},o.a.createElement(v.a,{item:!0,xs:12,sm:6},o.a.createElement(m.SectionHeader,{title:"Add a saved service",classes:{component:a.formHeading}}),o.a.createElement("form",{className:a.form},o.a.createElement(m.Dropdown,{label:"Saved services",placeholder:"Select a service",items:u.data.map((function(e){return{label:e.name,value:e}})),selectedIndex:this.state.selectedSavedServiceIndex,onChange:function(t,a){var r=t.value;e.setState({selectedSavedServiceIndex:a},(function(){l({name:r.name,billingType:r.billingType,paymentTotal:String(r.totalAmount),chargeGST:r.includeConsTax,perUnit:r.timeBasedType,isTemplate:!1,isAlreadySaved:!0,alreadySavedId:r.id}),e.setState({selectedSavedServiceIndex:-1})}))}})),o.a.createElement(m.SectionHeader,{title:"Create a new service",classes:{component:a.formHeading}}),o.a.createElement(P.Formik,{initialValues:{name:"",billingType:"",paymentTotal:"",chargeGST:!1,perUnit:"",isTemplate:!1},validationSchema:O.object().shape({name:O.string().required("Service Name is required"),billingType:O.string().required("Billing Type is required"),paymentTotal:O.string().required("Payment Total is required")}),onSubmit:function(e){l({name:e.name,billingType:e.billingType,paymentTotal:e.paymentTotal,chargeGST:e.chargeGST,perUnit:e.perUnit,isTemplate:e.isTemplate})}},(function(e){var t=e.values,r=e.errors,n=e.touched,i=e.handleChange,l=e.handleBlur,s=e.handleSubmit,p=(e.isSubmitting,e.setFieldValue);return o.a.createElement("form",{className:a.form,onSubmit:s},o.a.createElement("div",{className:a.input},o.a.createElement(m.TextField,{label:"Service name",placeholder:"E.g: Website development",showClearIcon:!1,name:"name",id:"name",value:t.name,onChange:i,onBlur:l,error:n.name&&r.name})),o.a.createElement("div",{className:C()(a.input)},o.a.createElement(m.Dropdown,{id:"billing-type",label:"Billing Type",placeholder:"Select type",onChange:function(e){p("billingType",e.value)},items:[{label:"Fixed",value:H.f.FIXED},{label:"Time Based",value:H.f.TIME_BASED}]})),t.billingType===H.f.FIXED&&o.a.createElement("div",{className:C()(a.halfFieldWRow,a.input)},o.a.createElement(m.TextField,{label:"Payment Total",placeholder:"E.g: 200",classes:{textInputWrapper:a.leftInput},showClearIcon:!1,name:"paymentTotal",id:"paymentTotal",value:t.paymentTotal,onChange:i,onBlur:l,error:n.paymentTotal&&r.paymentTotal}),o.a.createElement(m.Checkbox,{id:"charge-gst",label:"Charge "+d._("GST"),value:t.chargeGST,classes:{component:a.chargeGSTCheckbox},onChange:function(e){return p("chargeGST",e)}})),t.billingType===H.f.TIME_BASED&&o.a.createElement("div",null,o.a.createElement("div",{className:C()(a.halfFieldWRow,a.input)},o.a.createElement(m.TextField,{label:"Payment Amount",placeholder:"E.g: 200",classes:{textInputWrapper:a.leftInput},showClearIcon:!1,name:"paymentTotal",id:"paymentTotal",value:t.paymentTotal,onChange:i,onBlur:l,error:n.paymentTotal&&r.paymentTotal}),o.a.createElement(m.Checkbox,{id:"charge-gst",label:"Charge "+d._("GST"),value:t.chargeGST,classes:{component:a.chargeGSTCheckbox},onChange:function(e){return p("chargeGST",e)}})),o.a.createElement("div",{className:C()(a.input)},o.a.createElement(m.Dropdown,{id:"per-unit",label:"Per Unit",placeholder:"Select Unit",items:[{label:"Hour",value:"HOUR"},{label:"Half Hour",value:"HALFHOUR"},{label:"Quater Hour",value:"QUARTERHOUR"}],onChange:function(e){p("perUnit",e.value)}}))),o.a.createElement("div",{className:a.input},o.a.createElement(m.Checkbox,{classes:{wrapper:a.checkbox},value:t.isTemplate,label:"Save this service to templates",onChange:function(e){p("isTemplate",e)}})),o.a.createElement("div",{className:a.input},o.a.createElement(m.Button,{id:"add-service",title:"Add Service",buttonColor:c.palette.primary.color2,width:"200px",compactMode:!0,applyBorderRadius:!0,type:"submit"})))}))),o.a.createElement(v.a,{item:!0,xs:12,sm:6},o.a.createElement(m.SectionHeader,{title:"Added Services",classes:{component:a.formHeading}}),0===p.length&&o.a.createElement("div",{className:a.noServices},o.a.createElement("div",{className:a.noServicesText},"You have not added any services to this Project!")),p.length>0&&o.a.createElement("div",null,this.state.alertVisible&&this._isThereTimeBasedService()&&o.a.createElement("div",{className:a.serviceAlert,"data-test":"timebased-service-message"},o.a.createElement("div",{className:a.serviceAlertText},"Services based on time will be linked to timesheets."," ",o.a.createElement("br",null),"You can link this service when you create a timesheet."),o.a.createElement("div",{className:a.alertRemoveIcon,onClick:function(){e.setState({alertVisible:!1})}},o.a.createElement("i",{className:"ion-android-close"}))),o.a.createElement("div",{className:a.services},p.map((function(e,t){return o.a.createElement(G,{key:t,name:e.name,type:e.billingType,price:e.paymentTotal,perUnit:e.perUnit,chargeGST:e.chargeGST,onRemoveClick:function(){s(e.id)}})})))))))},t}(n.Component),q=Object(V.compose)(Object(m.withStyles)(g.c),Object(w.withI18n)(),Object(l.b)((function(e){return{createNewProject:h()(e,(function(e){return e.sessionData.newProject})),profile:e.profile}}),z({},d.a)),Object(R.withServices)((function(){return{variables:{where:{isArchived:!1,isTemplate:!0},orderBy:"name_ASC"}}})))(U),J=a(31),X=a.n(J),Y=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),K=function(){return(K=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={rules:null,selectedService:null,alertVisible:!0},t}return Y(t,e),t.prototype.componentDidMount=function(){var e=this.props.createNewProject.service;this.setState({selectedService:e.filter((function(e){return e.billingType===H.f.FIXED}))[0]})},t.prototype._getSelectedServicePaymentRules=function(){var e=this.props.createNewProject.service,t=F()(e,{id:h()(this.state,(function(e){return e.selectedService.id}))})||{},a=[];for(var r in t.paymentRule)t.paymentRule.hasOwnProperty(r)&&a.push(K(K({},t.paymentRule[r]),{period:r}));return a},t.prototype.render=function(){var e=this,t=this.props,a=t.classes,r=t.makeStepActive,n=t.unmarkedVisited,i=t.markedVisited,c=t.theme,l=t.createNewProject.service,s=t.addPaymentRule,p=t.i18n,u=this.state,d=u.selectedService,f=u.alertVisible,y=this._getSelectedServicePaymentRules();return o.a.createElement("div",null,o.a.createElement(m.SectionHeader,{title:"Payment Rules",subtitle:"Rules allow you to assign parameters to each service.",renderLeftPart:function(){return o.a.createElement("div",{className:a.prevNextWrapper},o.a.createElement(m.Button,{title:"Prev",classes:{component:a.prevNextButton},applyBorderRadius:!0,compactMode:!0,buttonColor:c.palette.primary.color2,withoutBackground:!0,onClick:function(){r(2),n(2)}}),o.a.createElement(m.Button,{title:"Review Project",id:"review-button",classes:{component:a.prevNextButton},applyBorderRadius:!0,compactMode:!0,buttonColor:c.palette.primary.color2,onClick:function(){r(4),i(3)}}))}}),o.a.createElement(v.a,{container:!0,classes:{container:a.content},spacing:40},o.a.createElement(v.a,{item:!0,xs:12,sm:4},o.a.createElement(m.SectionHeader,{title:"Select a Service"}),o.a.createElement("div",{className:a.rulesServices},l.map((function(t,r){return t.billingType===H.f.TIME_BASED?null:o.a.createElement("div",{className:C()(a.rulesService,{active:h()(d,(function(e){return e.id}))===t.id}),"data-test":"added-services-"+t.name,key:r,onClick:function(){e.setState({selectedService:t})}},o.a.createElement("div",{className:a.rulesServiceName},t.name),o.a.createElement("div",{className:a.rulesServiceAssign},p._("currency-symbol"),t.paymentTotal))}))),f&&o.a.createElement("div",{className:a.serviceAlert},o.a.createElement("div",{className:a.serviceAlertText},"Only fixed payment services can be assigned to a rule."),o.a.createElement("div",{className:a.alertRemoveIcon,onClick:function(){return e.setState({alertVisible:!1})}},o.a.createElement("i",{className:"ion-android-close"})))),o.a.createElement(v.a,{item:!0,xs:12,sm:8},o.a.createElement(P.Formik,{initialValues:{period:"",fixedOrPercent:"fixed",amount:""},validationSchema:O.object().shape({period:O.string().required("Please select time"),amount:O.string().required("Amount is required")}),onSubmit:function(t){var a=e.state.selectedService;s({serviceId:h()(a,(function(e){return e.id})),period:t.period,type:t.fixedOrPercent,amount:t.amount})}},(function(e){var t=e.values,r=e.errors,n=e.touched,i=e.handleChange,l=e.handleBlur,s=e.handleSubmit,u=(e.isSubmitting,e.setFieldValue);return o.a.createElement(v.a,{container:!0,component:"form",onSubmit:s,spacing:16,classes:{container:a.newRuleContainer}},o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement(m.SectionHeader,{title:"Create a new Rule"})),o.a.createElement(v.a,{item:!0,xs:12,sm:5},o.a.createElement("div",{className:C()(a.input)},o.a.createElement(m.Dropdown,{id:"new-rule-when",label:"When",placeholder:"Select a status",items:[{label:"Project starts",value:"projectBegins"},{label:"Project ends",value:"projectEnds"}],selectedIndex:"projectBegins"===t.period?0:"projectEnds"===t.period?1:null,onChange:function(e){u("period",e.value)}})),o.a.createElement("div",{className:a.input},o.a.createElement(m.Button,{id:"add-rule",title:"Add Rule",buttonColor:c.palette.primary.color2,width:"200px",compactMode:!0,applyBorderRadius:!0,type:"submit"}))),o.a.createElement(v.a,{item:!0,xs:12,sm:2},o.a.createElement("div",{className:C()(a.input)},o.a.createElement(m.ToggleButton,{id:"rule-type",title:"Type",selectedIndex:"fixed"===t.fixedOrPercent?0:1,labels:[p._("currency-symbol"),"%"],activeColor:c.palette.primary.color3,onChange:function(e,t){u("fixedOrPercent",0===t?"fixed":"percentage")}}))),o.a.createElement(v.a,{item:!0,xs:12,sm:5},o.a.createElement("div",{className:C()(a.input)},o.a.createElement(m.TextField,{label:"Amount",placeholder:"E.g: 200",showClearIcon:!1,name:"amount",id:"amount",value:t.amount,onChange:i,onBlur:l,error:n.amount&&r.amount}))),o.a.createElement(v.a,{item:!0,xs:12},o.a.createElement("div",{className:a.rulesList},X()(y)&&o.a.createElement("div",{className:a.noRules},"You haven’t assigned any rules"),!X()(y)&&o.a.createElement("div",null,y.map((function(e,t){return o.a.createElement("div",{className:a.rule,key:t,"data-test":"added-rules"},o.a.createElement("div",{className:a.ruleDescription},o.a.createElement("div",{className:a.ruleLabel},o.a.createElement("span",{className:a.highlightRuleText},"projectBegins"===e.period?"Project starts":"Project ends")),o.a.createElement("div",{className:C()(a.rulePercentage,a.highlightRuleText)},e.percentage,"%"),o.a.createElement("div",{className:a.ruleAmount},p._("currency-symbol"),e.amount)))})))),o.a.createElement("div",{className:a.serviceTotal},o.a.createElement("div",{className:a.serviceTotalLabel},"Service Total:"),o.a.createElement("div",{className:a.serviceTotalLabel},p._("currency-symbol"),h()(d,(function(e){return e.paymentTotal}))))))})))))},t}(n.Component),Z=Object(V.compose)(Object(w.withI18n)(),Object(m.withStyles)(g.c),Object(l.b)((function(e){return{createNewProject:h()(e,(function(e){return e.sessionData.newProject})),profile:e.profile}}),K({},d.a)))(Q),$=a(2103),ee=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),te=function(){return(te=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},ae=function(e){function t(t){var a=e.call(this,t)||this;return a._makeStepActive=function(e){var t=a.state.steps,r=c()(t,{active:!0});r>-1&&(t[r]=te(te({},t[r]),{active:!1}),t[e]=te(te({},t[e]),{active:!0}),a.setState({steps:t}))},a._markedVisited=function(e){var t=a.state.steps;t[e]=te(te({},t[e]),{visited:!0}),a.setState({steps:t})},a._unmarkedVisited=function(e){var t=a.state.steps;t[e]=te(te({},t[e]),{visited:!1}),a.setState({steps:t})},a._onStepClick=function(e,t){a._makeStepActive(t)},a.state={steps:[{label:"Project",active:!0,component:o.a.createElement(N,{makeStepActive:a._makeStepActive,markedVisited:a._markedVisited})},{label:"Customers",component:o.a.createElement(B,{makeStepActive:a._makeStepActive,markedVisited:a._markedVisited,unmarkedVisited:a._unmarkedVisited})},{label:"Services",component:o.a.createElement(q,{makeStepActive:a._makeStepActive,markedVisited:a._markedVisited,unmarkedVisited:a._unmarkedVisited})},{label:"Rules",component:o.a.createElement(Z,{makeStepActive:a._makeStepActive,markedVisited:a._markedVisited,unmarkedVisited:a._unmarkedVisited,history:a.props.history})},{label:"Review",component:o.a.createElement($.a,{makeStepActive:a._makeStepActive,markedVisited:a._markedVisited,unmarkedVisited:a._unmarkedVisited,history:a.props.history})}]},a}return ee(t,e),t.prototype.componentDidMount=function(){this.props.actions.updateHeaderTitle("Projects")},t.prototype.render=function(){var e=this,t=this.props,a=t.classes,r=t.theme;return o.a.createElement(m.ErrorBoundary,null,o.a.createElement(u.a,{onChange:function(){e.props.resetNewProjectData(),e.props.history.push(p.a.PROJECTS())}},o.a.createElement("div",{className:a.page},o.a.createElement("div",{className:a.allSteps},o.a.createElement(m.WizardSteps,{steps:this.state.steps,onStepClick:this._onStepClick})),o.a.createElement("div",{className:a.draftButtonWrapper},o.a.createElement(m.Button,{title:"Cancel",buttonColor:r.palette.grey[200],classes:{text:a.cancelButtonText}})))))},t}(n.Component);t.default=Object(s.compose)(Object(l.b)((function(){return{}}),{resetNewProjectData:d.a.resetNewProjectData}),Object(m.withStyles)(g.c))(ae)},25:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"f",(function(){return n})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return i})),a.d(t,"g",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return s}));var r="YYYY-MM-DD[T]HH:mm:ss.SSS[Z]",n={FIXED:"FIXED",TIME_BASED:"TIME_BASED"},o={STARTED:"STARTED",CLOSED:"CLOSED"},i={PROJECT_ENDS:"PROJECT_ENDS",PROJECT_STARTS:"PROJECT_STARTS"},c={APPROVED:"APPROVED",DRAFT:"DRAFT",FINALISED:"FINALISED",INVOICED:"INVOICED"},l={APPROVED:"APPROVED",ARCHIVED:"ARCHIVED",DRAFT:"DRAFT",FULLY_PAID:"FULLY_PAID",UNPAID:"UNPAID",PARTIALLY_PAID:"PARTIALLY_PAID",PROPOSED:"PROPOSED",REJECTED:"REJECTED"},s={PROJECT:"PROJECT",TIMESHEET:"TIMESHEET",TIMESHEET_WITH_DETAILS:"TIMESHEET_WITH_DETAILS",FREE_TEXT:"FREE_TEXT"}},27:function(e,t,a){"use strict";var r=a(0),n=a(18),o=a(15),i=a(317),c=a(9),l=a.n(c);t.a=Object(n.compose)(Object(o.b)((function(e){return{selectedCompany:l()(e,(function(e){return e.profile.selectedCompany}))}})))((function(e){var t=e.selectedCompany,a=e.onChange,n=e.children;return Object(i.a)((function(){a(t)}),[t]),r.createElement(r.Fragment,null,n)}))},317:function(e,t,a){"use strict";var r=a(30),n=a.n(r),o=a(0);function i(e){var t,a,r=Object(o.useRef)();return t=e,a=r.current,n()(t,a)||(r.current=e),r.current}t.a=function(e,t){Object(o.useEffect)(e,i(t))}}}]);